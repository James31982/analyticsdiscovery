---
title: "Business Forecasting Project"
author: "Jaime Paz"
og:
  type: "Project"
  title: "Applied Time Series Forecasting in Business"

footer:
  
  - content: 'Created by Jaime Paz. Tools used: R Markdown, Tidymodels, Tidyverse & Timetk'
date: "2022-02-14"
output: 
  html_document:
    keep_md: yes
  pdf_document: default
---

<center><img
src="https://dantaanalytics.com/wp-content/uploads/2021/02/Forecasting-Methods-in-Marketing.jpg"
width="1000" 
height="200">
</center>


    
    
The goal of this project is to propose a machine learning model capable to predict the revenue in our current company. The goal is to develop a forecasting tool that estimates our revenue during the next months, until the end of the year. 

Our data was sampled from our Finance application tool using data from 2017 through the current year 2021. The data was summarized using our commercial business lines (LOBs). Our department from Finance provide us the forecasted revenue (Actuals) **for the last 2 months (August / September)**, so in short, our main goal is to find a model or models that can better predict these actual revenue values.

**Business Value:** Recently, our team from finance is estimating the revenue every end of the month and providing to us the “Best Estimate projection”. However, our commercial team is proposing to create a new tool that should be capable to give better and accurate results during the next 2 months, and consecuently, the upcoming months. 


## Tools used

The tools used for this project are:
**R Programming & forecasting packages:** The “R programming language” provides us a vast utilities specially for data science and forecasting models. But during the last years, there is a new set of packages called “Tidyverse”, “Tidymodels” & "Timetk", which are useful for machine learning / forecasting tasks. 

These set of tools integrate several data science packages into one single universe, but also gives highly potential tools such as: creating workflows and recipes to compare several models; parallel programming (which gives the utility to forecast several time series at once) and a lot more. In regard to the forecasting tools, we have a great portfolio from traditional models (such as ARIMA and Moving Average) to advanced algorithms such as Deep Learning, XGBoost, Neural Nets, etc.

**R Markdown:** R also provides a set of tools to publish our work using documents and HTML sources, to provide a better executive look & feel and present our work to massive audiences. 

### 1. List of packages used


```r
rm(list=ls())

setwd("/home/analytics/R/Projects/Time Series 2")

# Forecasting Libraries ----
library(forecast)    
# Machine Learning Libraries ----
library(glmnet)       
library(randomForest) 
library(xgboost)     
# Machine Learning: Ensembles
library(modeltime.ensemble)
# Time Series ML ----
library(tidymodels)   
library(rules)        
library(modeltime)    
# Core Libraries ----
library(tidyverse)    
library(lubridate)    
library(timetk)       
# Timing & Parallel Processing
library(tictoc)
library(future)
library(doFuture)
# Extras
library(fs)
library(dplyr)
library(tidyquant)
library(readxl)
library(hrbrthemes)
library(plotly)
```


### 2. Collecting & Preparing Data

The fist step is to get the data by executing MDX based-queries from our cube of finance and then been able to collect it into an Excel spreadsheet. 

The basic steps are: Collect data, convert nomenclatures, convert time-based columns to date & filtering the data. Our category “Forecast” contains the predictions from the traditional model from Finance. Our goal is to improve these numbers.



```r
# Reading the spreadsheet
financials <- read_excel('/home/analytics/R/Projects/Time Series 2/00_data/FinancialsV3.xlsx',
                         sheet = 1, col_names = TRUE)

financials$Category...1 <- NULL

# Pivoting our data and converting our data
fin_data <- financials %>%
  gather(key = "Month", value = "Value", c(Jan, Feb, Mar, Apr, May, 
                                           Jun, Jul, Aug, Sep, Oct, Nov, Dec))  %>%
    group_by(LOB, Year, Category...3, Metric, Month) %>%
      summarise(Value = sum(Value)) %>%
        mutate(Month = case_when(
        Month == "Jan" ~ "01",
        Month == "Feb" ~ "02",
        Month == "Mar" ~ "03",
        Month == "Apr" ~ "04",
        Month == "May" ~ "05",
        Month == "Jun" ~ "06",
        Month == "Jul" ~ "07",
        Month == "Aug" ~ "08",
        Month == "Sep" ~ "09",
        Month == "Oct" ~ "10",
        Month == "Nov" ~ "11",
        Month == "Dec" ~ "12",
        TRUE ~ Month)) %>%  
      mutate(Date = paste0(Year,"-",Month,"-","01") %>% as_date()) %>% ungroup() %>%
        rename(Category = Category...3) %>%
        mutate(Group = case_when(
        LOB == 'LOB 1' ~ 'G1',
        LOB == 'LOB 2' ~ 'G1',
        LOB == 'LOB 3' ~ 'G2',
        LOB == 'LOB 4' ~ 'G2',
        LOB == 'LOB 5' ~ 'G3',
        LOB == 'LOB 6' ~ 'G3',
        LOB == 'LOB 7' ~ 'G4',
        TRUE ~ LOB)) %>% 
  filter_by_time(.start_date = "2017-01-01", .end_date = "2021-09-01") %>% 
    group_by(LOB, Year, Category, Metric, Month, Group) %>%
      summarise_by_time(
        .by        = "month",
        Value      = last(Value),
        .type      = "ceiling") %>% 
        mutate(Date = Date %-time% "1 day")  %>% ungroup()

# fin_data will exclude traditional forecasting tool (we will replace a new method)
fin_data <- fin_data %>% filter(!(Date < "2021-07-31" &
                        Category == 'Forecast')  ) 
fin_data$Year <- NULL
fin_data$Month <- NULL

# Filter by Category and Metric (Actuals and Revenue)
fin_data_ac_rev <- fin_data %>% filter(Category == 'Actuals' & Metric == 'Revenue' ) 
```

Main data will be stored in **fin_data_ac_rev** dataframe. 

This is the output of our data structure:


```r
fin_data_ac_rev %>% head(5)
```

```
## # A tibble: 5 × 6
##   LOB   Category Metric  Group Date        Value
##   <chr> <chr>    <chr>   <chr> <date>      <dbl>
## 1 LOB 1 Actuals  Revenue G1    2017-01-31 23965.
## 2 LOB 1 Actuals  Revenue G1    2017-02-28 23056.
## 3 LOB 1 Actuals  Revenue G1    2017-03-31 29634.
## 4 LOB 1 Actuals  Revenue G1    2017-04-30 25861.
## 5 LOB 1 Actuals  Revenue G1    2017-05-31 27389.
```
How our data looks like:


```r
fin_data_ac_rev %>% head(5)
```

```
## # A tibble: 5 × 6
##   LOB   Category Metric  Group Date        Value
##   <chr> <chr>    <chr>   <chr> <date>      <dbl>
## 1 LOB 1 Actuals  Revenue G1    2017-01-31 23965.
## 2 LOB 1 Actuals  Revenue G1    2017-02-28 23056.
## 3 LOB 1 Actuals  Revenue G1    2017-03-31 29634.
## 4 LOB 1 Actuals  Revenue G1    2017-04-30 25861.
## 5 LOB 1 Actuals  Revenue G1    2017-05-31 27389.
```


### 3.0 Trend Analysis 


We then summarize our data to understand if there is any trend or patter in the time series:


```r
# Merging all LOBs

fin_data_ac_rev_bus <- fin_data %>% filter(Category == 'Actuals' & Metric == 'Revenue') %>%
  select(Date, Value) %>%
  group_by(Date) %>% summarize(Value = sum(Value)) 

# Plotting current revenue
fin_data_ac_rev_bus %>%
  plot_time_series(Date, Value, .smooth = FALSE, 
                   .facet_scales = "free",
                   .title = "Commercial Business Revenue (Actuals)" )  
```

```{=html}
<div id="htmlwidget-66edba98825680a01a4c" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-66edba98825680a01a4c">{"x":{"data":[{"x":["2017-01-31","2017-02-28","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31","2020-09-30","2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[283845.1109096,288363.5169264,313200.5167376,288545.769536,297216.3138096,296268.7962,286852.0472688,286410.296508,285995.191188,282791.1455904,285939.0306016,311327.6751464,275770.2112904,265038.6583528,279979.928504,257303.6350232,277339.8600792,285188.8252296,253510.4030584,264970.357896,247324.5236632,260382.3009152,254805.532608,287422.817092,236286.5009408,234069.963664,249041.4029272,242121.575316,242681.0526896,247066.9263704,236875.0218288,228429.6309576,224787.465264,237336.4222496,244671.593276,253551.9934912,226774.592092,229099.105296,231749.0690216,217826.5753656,204997.928516,214397.3558328,214579.3417784,207044.4609328,210526.7354168,218159.749664,212774.6818424,232338.1399328,194277.4611912,196736.480668,212911.0911712,203828.2543416,202232.6398264,210098.601904,199275.6633448,194056.391192,204194.0703472],"text":["Date: 2017-01-31<br />.value: 283845.1","Date: 2017-02-28<br />.value: 288363.5","Date: 2017-03-31<br />.value: 313200.5","Date: 2017-04-30<br />.value: 288545.8","Date: 2017-05-31<br />.value: 297216.3","Date: 2017-06-30<br />.value: 296268.8","Date: 2017-07-31<br />.value: 286852.0","Date: 2017-08-31<br />.value: 286410.3","Date: 2017-09-30<br />.value: 285995.2","Date: 2017-10-31<br />.value: 282791.1","Date: 2017-11-30<br />.value: 285939.0","Date: 2017-12-31<br />.value: 311327.7","Date: 2018-01-31<br />.value: 275770.2","Date: 2018-02-28<br />.value: 265038.7","Date: 2018-03-31<br />.value: 279979.9","Date: 2018-04-30<br />.value: 257303.6","Date: 2018-05-31<br />.value: 277339.9","Date: 2018-06-30<br />.value: 285188.8","Date: 2018-07-31<br />.value: 253510.4","Date: 2018-08-31<br />.value: 264970.4","Date: 2018-09-30<br />.value: 247324.5","Date: 2018-10-31<br />.value: 260382.3","Date: 2018-11-30<br />.value: 254805.5","Date: 2018-12-31<br />.value: 287422.8","Date: 2019-01-31<br />.value: 236286.5","Date: 2019-02-28<br />.value: 234070.0","Date: 2019-03-31<br />.value: 249041.4","Date: 2019-04-30<br />.value: 242121.6","Date: 2019-05-31<br />.value: 242681.1","Date: 2019-06-30<br />.value: 247066.9","Date: 2019-07-31<br />.value: 236875.0","Date: 2019-08-31<br />.value: 228429.6","Date: 2019-09-30<br />.value: 224787.5","Date: 2019-10-31<br />.value: 237336.4","Date: 2019-11-30<br />.value: 244671.6","Date: 2019-12-31<br />.value: 253552.0","Date: 2020-01-31<br />.value: 226774.6","Date: 2020-02-29<br />.value: 229099.1","Date: 2020-03-31<br />.value: 231749.1","Date: 2020-04-30<br />.value: 217826.6","Date: 2020-05-31<br />.value: 204997.9","Date: 2020-06-30<br />.value: 214397.4","Date: 2020-07-31<br />.value: 214579.3","Date: 2020-08-31<br />.value: 207044.5","Date: 2020-09-30<br />.value: 210526.7","Date: 2020-10-31<br />.value: 218159.7","Date: 2020-11-30<br />.value: 212774.7","Date: 2020-12-31<br />.value: 232338.1","Date: 2021-01-31<br />.value: 194277.5","Date: 2021-02-28<br />.value: 196736.5","Date: 2021-03-31<br />.value: 212911.1","Date: 2021-04-30<br />.value: 203828.3","Date: 2021-05-31<br />.value: 202232.6","Date: 2021-06-30<br />.value: 210098.6","Date: 2021-07-31<br />.value: 199275.7","Date: 2021-08-31<br />.value: 194056.4","Date: 2021-09-30<br />.value: 204194.1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":46.027397260274},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Commercial Business Revenue (Actuals)","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["2016-11-06","2021-12-24"],"tickmode":"auto","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[188099.18491472,319157.72301488],"tickmode":"auto","ticktext":["200000","240000","280000"],"tickvals":[200000,240000,280000],"categoryorder":"array","categoryarray":["200000","240000","280000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4906437e83e":{"x":{},"y":{},"type":"scatter"}},"cur_data":"4906437e83e","visdat":{"4906437e83e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```


By the middle of 2020, our revenue trend seems to be stabilized, compared to the previous years. Also, our commercial revenue had been decreasing from the middle of 2017 to the middle of 2020 in about **27.6 %** :


```r
detrend <- fin_data_ac_rev_bus %>% summarize_by_time(.date_var=Date, .by = 'month', value = mean(Value)) %>%
  filter(Date == '2017-06-01' | Date == '2020-06-01')

paste0(100 * (detrend$value[2] - detrend$value[1]) / detrend$value[1], " %")
```

```
## [1] "-27.6341759298646 %"
```


By the end of September 2021, we are reporting about **$204,194** on current revenue.

Now, let's compare our actual revenue against the forecasted revenue (traditional way):



```r
fin_data_rev_bus <- fin_data %>% filter(Category %in% c('Actuals', 'Forecast') & Metric == 'Revenue') %>%
  select(Category, Date, Value) %>%
  group_by(Category, Date) %>%
  summarize(Value = sum(Value)) 

fin_data_rev_bus %>% ungroup() %>%
  plot_time_series(Date, Value, .color_var = Category, .smooth = FALSE,
                   .title = "Commercial Business Revenue (Actuals vs Forecast)")
```

```{=html}
<div id="htmlwidget-5b91e8b9ddfdcb98630b" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5b91e8b9ddfdcb98630b">{"x":{"data":[{"x":["2017-01-31","2017-02-28","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31","2020-09-30","2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[283845.1109096,288363.5169264,313200.5167376,288545.769536,297216.3138096,296268.7962,286852.0472688,286410.296508,285995.191188,282791.1455904,285939.0306016,311327.6751464,275770.2112904,265038.6583528,279979.928504,257303.6350232,277339.8600792,285188.8252296,253510.4030584,264970.357896,247324.5236632,260382.3009152,254805.532608,287422.817092,236286.5009408,234069.963664,249041.4029272,242121.575316,242681.0526896,247066.9263704,236875.0218288,228429.6309576,224787.465264,237336.4222496,244671.593276,253551.9934912,226774.592092,229099.105296,231749.0690216,217826.5753656,204997.928516,214397.3558328,214579.3417784,207044.4609328,210526.7354168,218159.749664,212774.6818424,232338.1399328,194277.4611912,196736.480668,212911.0911712,203828.2543416,202232.6398264,210098.601904,199275.6633448,194056.391192,204194.0703472],"text":[".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-01-31<br />.value: 283845.1",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-02-28<br />.value: 288363.5",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-03-31<br />.value: 313200.5",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-04-30<br />.value: 288545.8",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-05-31<br />.value: 297216.3",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-06-30<br />.value: 296268.8",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-07-31<br />.value: 286852.0",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-08-31<br />.value: 286410.3",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-09-30<br />.value: 285995.2",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-10-31<br />.value: 282791.1",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-11-30<br />.value: 285939.0",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2017-12-31<br />.value: 311327.7",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-01-31<br />.value: 275770.2",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-02-28<br />.value: 265038.7",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-03-31<br />.value: 279979.9",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-04-30<br />.value: 257303.6",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-05-31<br />.value: 277339.9",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-06-30<br />.value: 285188.8",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-07-31<br />.value: 253510.4",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-08-31<br />.value: 264970.4",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-09-30<br />.value: 247324.5",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-10-31<br />.value: 260382.3",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-11-30<br />.value: 254805.5",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2018-12-31<br />.value: 287422.8",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-01-31<br />.value: 236286.5",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-02-28<br />.value: 234070.0",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-03-31<br />.value: 249041.4",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-04-30<br />.value: 242121.6",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-05-31<br />.value: 242681.1",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-06-30<br />.value: 247066.9",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-07-31<br />.value: 236875.0",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-08-31<br />.value: 228429.6",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-09-30<br />.value: 224787.5",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-10-31<br />.value: 237336.4",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-11-30<br />.value: 244671.6",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2019-12-31<br />.value: 253552.0",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-01-31<br />.value: 226774.6",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-02-29<br />.value: 229099.1",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-03-31<br />.value: 231749.1",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-04-30<br />.value: 217826.6",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-05-31<br />.value: 204997.9",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-06-30<br />.value: 214397.4",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-07-31<br />.value: 214579.3",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-08-31<br />.value: 207044.5",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-09-30<br />.value: 210526.7",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-10-31<br />.value: 218159.7",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-11-30<br />.value: 212774.7",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2020-12-31<br />.value: 232338.1",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-01-31<br />.value: 194277.5",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-02-28<br />.value: 196736.5",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-03-31<br />.value: 212911.1",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-04-30<br />.value: 203828.3",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-05-31<br />.value: 202232.6",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-06-30<br />.value: 210098.6",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-07-31<br />.value: 199275.7",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-08-31<br />.value: 194056.4",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-09-30<br />.value: 204194.1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"Actuals","legendgroup":"Actuals","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-07-31","2021-08-31","2021-09-30"],"y":[199222.092233291,208041.646948809,210630.068549162],"text":[".color_mod: Forecast<br />.color_mod: Forecast<br />Date: 2021-07-31<br />.value: 199222.1",".color_mod: Forecast<br />.color_mod: Forecast<br />Date: 2021-08-31<br />.value: 208041.6",".color_mod: Forecast<br />.color_mod: Forecast<br />Date: 2021-09-30<br />.value: 210630.1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"Forecast","legendgroup":"Forecast","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":46.027397260274},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Commercial Business Revenue (Actuals vs Forecast)","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["2016-11-06","2021-12-24"],"tickmode":"auto","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[188099.18491472,319157.72301488],"tickmode":"auto","ticktext":["200000","240000","280000"],"tickvals":[200000,240000,280000],"categoryorder":"array","categoryarray":["200000","240000","280000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"Legend","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"49064e41cec":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"49064e41cec","visdat":{"49064e41cec":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

Clearly we can see a gap of 3% between the actual value and the forecasted value by the end of September 2021. 



```r
fin_data_rev_bus %>% filter_by_time(.date_var = Date, 
                                                  .start_date = '2021-06-30', .end_date = '2021-09-30') %>% ungroup() %>% 
  plot_time_series(Date, Value, .color_var = Category, .smooth = FALSE,
                   .title = "Commercial Business Revenue (Actuals vs Forecast)")
```

```{=html}
<div id="htmlwidget-8cf89133a242962dde37" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8cf89133a242962dde37">{"x":{"data":[{"x":["2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[210098.601904,199275.6633448,194056.391192,204194.0703472],"text":[".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-06-30<br />.value: 210098.6",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-07-31<br />.value: 199275.7",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-08-31<br />.value: 194056.4",".color_mod: Actuals<br />.color_mod: Actuals<br />Date: 2021-09-30<br />.value: 204194.1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"Actuals","legendgroup":"Actuals","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-07-31","2021-08-31","2021-09-30"],"y":[199222.092233291,208041.646948809,210630.068549162],"text":[".color_mod: Forecast<br />.color_mod: Forecast<br />Date: 2021-07-31<br />.value: 199222.1",".color_mod: Forecast<br />.color_mod: Forecast<br />Date: 2021-08-31<br />.value: 208041.6",".color_mod: Forecast<br />.color_mod: Forecast<br />Date: 2021-09-30<br />.value: 210630.1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"Forecast","legendgroup":"Forecast","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":46.027397260274},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Commercial Business Revenue (Actuals vs Forecast)","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["2021-06-25","2021-10-04"],"tickmode":"auto","ticktext":["Jul","Aug","Sep","Oct"],"tickvals":[18809,18840,18871,18901],"categoryorder":"array","categoryarray":["Jul","Aug","Sep","Oct"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[193227.707324142,211458.75241702],"tickmode":"auto","ticktext":["195000","200000","205000","210000"],"tickvals":[195000,200000,205000,210000],"categoryorder":"array","categoryarray":["195000","200000","205000","210000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"Legend","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4902e5b769f":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"4902e5b769f","visdat":{"4902e5b769f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

Despite giving us a good result, there is a lot we can improve. For instance, the model doesn't seem to capture and follow the current trend pretty well. Due to other external variables and other systematic events that we cannot control, the errors are pretty high. We can come up with a model to asses if we can capture these errors and try to follow the pattern using this historical data.  

### 3.1 Correlation Analysis (between lags) 


```r
fin_data_ac_rev_bus %>% plot_acf_diagnostics(Value, log_interval_vec(Value, offset = 1000000),
                                           .lags = 100)  
```

```{=html}
<div id="htmlwidget-4ea149b15b49ff63f8aa" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4ea149b15b49ff63f8aa">{"x":{"data":[{"x":[-2.8,58.8],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.8,58.8],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","mode":"","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","mode":"","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],"y":[1,0.757447158630298,0.718397165880328,0.678593314417477,0.603551778407166,0.587504930961684,0.601640088078664,0.514951011494312,0.447672217716518,0.481947459385814,0.373923786473149,0.32437138679131,0.348327977331564,0.209198429220179,0.186848327256142,0.181657078002478,0.114646991895561,0.084120550233996,0.0523038721781814,0.0287596440210016,-0.0307965218435043,-0.00208287718142287,-0.0656762261524555,-0.0825518101021704,-0.0842120442885873,-0.143520555507825,-0.163824462784006,-0.172897217412898,-0.199227535544396,-0.231528184730852,-0.23298453637998,-0.245620246881229,-0.274897199818633,-0.265378851293976,-0.278288161503639,-0.298728519274661,-0.294521187137884,-0.338921736848167,-0.354895742183281,-0.345236840543955,-0.333972180727604,-0.328249746194762,-0.319848420657325,-0.31302026397694,-0.321727032780964,-0.292154059304733,-0.266139738004182,-0.251907751895633,-0.23351932745721,-0.217010960975117,-0.199278382403177,-0.176953411994395,-0.1526215302904,-0.125259535262802,-0.0998874038226977,-0.0411434206223896,-0.017379544591967],"text":["lag:  0<br />value:  1.000000000<br />name: #2c3e50","lag:  1<br />value:  0.757447159<br />name: #2c3e50","lag:  2<br />value:  0.718397166<br />name: #2c3e50","lag:  3<br />value:  0.678593314<br />name: #2c3e50","lag:  4<br />value:  0.603551778<br />name: #2c3e50","lag:  5<br />value:  0.587504931<br />name: #2c3e50","lag:  6<br />value:  0.601640088<br />name: #2c3e50","lag:  7<br />value:  0.514951011<br />name: #2c3e50","lag:  8<br />value:  0.447672218<br />name: #2c3e50","lag:  9<br />value:  0.481947459<br />name: #2c3e50","lag: 10<br />value:  0.373923786<br />name: #2c3e50","lag: 11<br />value:  0.324371387<br />name: #2c3e50","lag: 12<br />value:  0.348327977<br />name: #2c3e50","lag: 13<br />value:  0.209198429<br />name: #2c3e50","lag: 14<br />value:  0.186848327<br />name: #2c3e50","lag: 15<br />value:  0.181657078<br />name: #2c3e50","lag: 16<br />value:  0.114646992<br />name: #2c3e50","lag: 17<br />value:  0.084120550<br />name: #2c3e50","lag: 18<br />value:  0.052303872<br />name: #2c3e50","lag: 19<br />value:  0.028759644<br />name: #2c3e50","lag: 20<br />value: -0.030796522<br />name: #2c3e50","lag: 21<br />value: -0.002082877<br />name: #2c3e50","lag: 22<br />value: -0.065676226<br />name: #2c3e50","lag: 23<br />value: -0.082551810<br />name: #2c3e50","lag: 24<br />value: -0.084212044<br />name: #2c3e50","lag: 25<br />value: -0.143520556<br />name: #2c3e50","lag: 26<br />value: -0.163824463<br />name: #2c3e50","lag: 27<br />value: -0.172897217<br />name: #2c3e50","lag: 28<br />value: -0.199227536<br />name: #2c3e50","lag: 29<br />value: -0.231528185<br />name: #2c3e50","lag: 30<br />value: -0.232984536<br />name: #2c3e50","lag: 31<br />value: -0.245620247<br />name: #2c3e50","lag: 32<br />value: -0.274897200<br />name: #2c3e50","lag: 33<br />value: -0.265378851<br />name: #2c3e50","lag: 34<br />value: -0.278288162<br />name: #2c3e50","lag: 35<br />value: -0.298728519<br />name: #2c3e50","lag: 36<br />value: -0.294521187<br />name: #2c3e50","lag: 37<br />value: -0.338921737<br />name: #2c3e50","lag: 38<br />value: -0.354895742<br />name: #2c3e50","lag: 39<br />value: -0.345236841<br />name: #2c3e50","lag: 40<br />value: -0.333972181<br />name: #2c3e50","lag: 41<br />value: -0.328249746<br />name: #2c3e50","lag: 42<br />value: -0.319848421<br />name: #2c3e50","lag: 43<br />value: -0.313020264<br />name: #2c3e50","lag: 44<br />value: -0.321727033<br />name: #2c3e50","lag: 45<br />value: -0.292154059<br />name: #2c3e50","lag: 46<br />value: -0.266139738<br />name: #2c3e50","lag: 47<br />value: -0.251907752<br />name: #2c3e50","lag: 48<br />value: -0.233519327<br />name: #2c3e50","lag: 49<br />value: -0.217010961<br />name: #2c3e50","lag: 50<br />value: -0.199278382<br />name: #2c3e50","lag: 51<br />value: -0.176953412<br />name: #2c3e50","lag: 52<br />value: -0.152621530<br />name: #2c3e50","lag: 53<br />value: -0.125259535<br />name: #2c3e50","lag: 54<br />value: -0.099887404<br />name: #2c3e50","lag: 55<br />value: -0.041143421<br />name: #2c3e50","lag: 56<br />value: -0.017379545<br />name: #2c3e50"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(44,62,80,1)","opacity":1,"size":3.77952755905512,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)"}},"frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],"y":[1,0.757447158630298,0.339385078614242,0.16452547013662,-0.0201727600389955,0.0814625654371422,0.174457028959498,-0.115546894674166,-0.154832155413716,0.178928696460376,-0.140242316774504,-0.137299997598244,0.122812723313937,-0.223813586238105,-0.022583206900297,0.0408374217265173,-0.0293593341217024,0.00331195114754401,-0.141841433180581,0.1614166971275,-0.0540413427094742,-0.0557474420553322,0.0513061918315483,-0.0052898615890384,-0.0551901020649006,-0.0565719917075602,-0.0549180993902273,0.0188001673779688,-0.0803622253598885,-0.0509110069958854,0.0335780477885877,-0.0487530964653355,-0.00926701651896156,-0.024230071112379,0.0376421311403993,-0.0352693364922296,-0.0663596050102794,-0.0667064291252335,-0.056101715246988,0.0180524384505308,0.0159587189860488,0.0444424480620033,-0.0353822842001753,-0.00886264508503059,0.0150507660811056,0.0144623762079394,0.0494471187017508,0.0185986708178858,-0.033421942265108,0.0375873859831702,-0.013100192706385,-0.0338778548284753,0.00456351938131309,0.029443391623771,0.0447665291483672,0.0570480970927362,0.0312544737944045],"text":["lag:  0<br />value:  1.000000000<br />name: #2c3e50","lag:  1<br />value:  0.757447159<br />name: #2c3e50","lag:  2<br />value:  0.339385079<br />name: #2c3e50","lag:  3<br />value:  0.164525470<br />name: #2c3e50","lag:  4<br />value: -0.020172760<br />name: #2c3e50","lag:  5<br />value:  0.081462565<br />name: #2c3e50","lag:  6<br />value:  0.174457029<br />name: #2c3e50","lag:  7<br />value: -0.115546895<br />name: #2c3e50","lag:  8<br />value: -0.154832155<br />name: #2c3e50","lag:  9<br />value:  0.178928696<br />name: #2c3e50","lag: 10<br />value: -0.140242317<br />name: #2c3e50","lag: 11<br />value: -0.137299998<br />name: #2c3e50","lag: 12<br />value:  0.122812723<br />name: #2c3e50","lag: 13<br />value: -0.223813586<br />name: #2c3e50","lag: 14<br />value: -0.022583207<br />name: #2c3e50","lag: 15<br />value:  0.040837422<br />name: #2c3e50","lag: 16<br />value: -0.029359334<br />name: #2c3e50","lag: 17<br />value:  0.003311951<br />name: #2c3e50","lag: 18<br />value: -0.141841433<br />name: #2c3e50","lag: 19<br />value:  0.161416697<br />name: #2c3e50","lag: 20<br />value: -0.054041343<br />name: #2c3e50","lag: 21<br />value: -0.055747442<br />name: #2c3e50","lag: 22<br />value:  0.051306192<br />name: #2c3e50","lag: 23<br />value: -0.005289862<br />name: #2c3e50","lag: 24<br />value: -0.055190102<br />name: #2c3e50","lag: 25<br />value: -0.056571992<br />name: #2c3e50","lag: 26<br />value: -0.054918099<br />name: #2c3e50","lag: 27<br />value:  0.018800167<br />name: #2c3e50","lag: 28<br />value: -0.080362225<br />name: #2c3e50","lag: 29<br />value: -0.050911007<br />name: #2c3e50","lag: 30<br />value:  0.033578048<br />name: #2c3e50","lag: 31<br />value: -0.048753096<br />name: #2c3e50","lag: 32<br />value: -0.009267017<br />name: #2c3e50","lag: 33<br />value: -0.024230071<br />name: #2c3e50","lag: 34<br />value:  0.037642131<br />name: #2c3e50","lag: 35<br />value: -0.035269336<br />name: #2c3e50","lag: 36<br />value: -0.066359605<br />name: #2c3e50","lag: 37<br />value: -0.066706429<br />name: #2c3e50","lag: 38<br />value: -0.056101715<br />name: #2c3e50","lag: 39<br />value:  0.018052438<br />name: #2c3e50","lag: 40<br />value:  0.015958719<br />name: #2c3e50","lag: 41<br />value:  0.044442448<br />name: #2c3e50","lag: 42<br />value: -0.035382284<br />name: #2c3e50","lag: 43<br />value: -0.008862645<br />name: #2c3e50","lag: 44<br />value:  0.015050766<br />name: #2c3e50","lag: 45<br />value:  0.014462376<br />name: #2c3e50","lag: 46<br />value:  0.049447119<br />name: #2c3e50","lag: 47<br />value:  0.018598671<br />name: #2c3e50","lag: 48<br />value: -0.033421942<br />name: #2c3e50","lag: 49<br />value:  0.037587386<br />name: #2c3e50","lag: 50<br />value: -0.013100193<br />name: #2c3e50","lag: 51<br />value: -0.033877855<br />name: #2c3e50","lag: 52<br />value:  0.004563519<br />name: #2c3e50","lag: 53<br />value:  0.029443392<br />name: #2c3e50","lag: 54<br />value:  0.044766529<br />name: #2c3e50","lag: 55<br />value:  0.057048097<br />name: #2c3e50","lag: 56<br />value:  0.031254474<br />name: #2c3e50"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(44,62,80,1)","opacity":1,"size":3.77952755905512,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)"}},"frame":null}],"layout":{"margin":{"t":55.4520547945205,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Lag Diagnostics","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[-2.8,58.8],"tickmode":"auto","ticktext":["0","20","40"],"tickvals":[0,20,40],"categoryorder":"array","categoryarray":["0","20","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"annotations":[{"text":"Lag","x":0.5,"y":-0.0353881278538813,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"Correlation","x":-0.0318003913894325,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis"},{"text":"ACF","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"PACF","x":0.5,"y":0.437443821234674,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0.562556178765326,1],"automargin":true,"type":"linear","autorange":true,"range":[-0.422640529292445,1.06774478710916],"tickmode":"auto","ticktext":["0.0","0.5","1.0"],"tickvals":[0,0.5,1],"categoryorder":"array","categoryarray":["0.0","0.5","1.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.562556178765326,"y1":1},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.437443821234674},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":0.437443821234674,"ysizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":true,"range":[-0.422640529292445,1.06774478710916],"tickmode":"auto","ticktext":["0.0","0.5","1.0"],"tickvals":[0,0.5,1],"categoryorder":"array","categoryarray":["0.0","0.5","1.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.437443821234674],"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4907c524759":{"yintercept":{},"type":"scatter"},"490222ada6d":{"y":{}},"49077f6cf7f":{"x":{},"y":{},"colour":{}},"4902eb770ef":{"x":{},"y":{},"colour":{}}},"cur_data":"4907c524759","visdat":{"4907c524759":["function (y) ","x"],"490222ada6d":["function (y) ","x"],"49077f6cf7f":["function (y) ","x"],"4902eb770ef":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

After executing some correlation analysis, we can spot some seasonality on the Partial Correlation Plot (2nd graph). Here we are showing all the lags list and the seasonality is spotted from lags 6 to 19. This means that the data is showing strong relationships between these points and we should assess if this variations are significant during our analysis.

*Note:* We are applying *log transformations* in order to make our data more smooth and so we can spot the variations more clearly.

### 3.2 Seasonality/trend/remainder diagnostics


```r
fin_data_ac_rev_bus %>%
  plot_stl_diagnostics(Date, log_interval_vec(Value, offset = 1000000), 
                       .facet_scales = "free_y",
                       .feature_set = c( "observed", "season", "trend", "remainder"))
```

```{=html}
<div id="htmlwidget-7befe9cb18c0d59e709d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7befe9cb18c0d59e709d">{"x":{"data":[{"x":[17197,17225,17256,17286,17317,17347,17378,17409,17439,17470,17500,17531,17562,17590,17621,17651,17682,17712,17743,17774,17804,17835,17865,17896,17927,17955,17986,18016,18047,18077,18108,18139,18169,18200,18230,18261,18292,18321,18352,18382,18413,18443,18474,18505,18535,18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[3.43748340379934,3.55695144384066,4.70247377280343,3.56206429544383,3.83939888721053,3.80526931084536,3.51547395310301,3.50365159946285,3.49266101496916,3.41144437489182,3.49118276517713,4.55505084269249,3.25247463371326,3.04724302338079,3.34494165972207,2.91999597151815,3.28603102122207,3.47163058510495,2.86254492924895,3.04605278114889,2.7747380527224,2.96890499038017,2.88183043008483,3.53094683574792,2.63316067017813,2.60671938724854,2.79843133366039,2.70581561241646,2.71302998756089,2.77122555467501,2.64028400775314,2.54203055273068,2.5020831338712,2.6458996254949,2.73907395745148,2.86315911186577,2.5237094304087,2.54952373410875,2.57966468891916,2.42930294712594,2.30576685260945,2.39502065367538,2.39681554701187,2.32464842061526,2.35746608370458,2.43268673230254,2.37913394909263,2.58647207682002,2.2113407951393,2.23237099994159,2.38046140925881,2.29510501189753,2.28070873937084,2.35338302887381,2.25446761413742,2.20946744252404,2.29842952757421],"text":["Date: 2017-01-31<br />.group_value:  3.437483e+00","Date: 2017-02-28<br />.group_value:  3.556951e+00","Date: 2017-03-31<br />.group_value:  4.702474e+00","Date: 2017-04-30<br />.group_value:  3.562064e+00","Date: 2017-05-31<br />.group_value:  3.839399e+00","Date: 2017-06-30<br />.group_value:  3.805269e+00","Date: 2017-07-31<br />.group_value:  3.515474e+00","Date: 2017-08-31<br />.group_value:  3.503652e+00","Date: 2017-09-30<br />.group_value:  3.492661e+00","Date: 2017-10-31<br />.group_value:  3.411444e+00","Date: 2017-11-30<br />.group_value:  3.491183e+00","Date: 2017-12-31<br />.group_value:  4.555051e+00","Date: 2018-01-31<br />.group_value:  3.252475e+00","Date: 2018-02-28<br />.group_value:  3.047243e+00","Date: 2018-03-31<br />.group_value:  3.344942e+00","Date: 2018-04-30<br />.group_value:  2.919996e+00","Date: 2018-05-31<br />.group_value:  3.286031e+00","Date: 2018-06-30<br />.group_value:  3.471631e+00","Date: 2018-07-31<br />.group_value:  2.862545e+00","Date: 2018-08-31<br />.group_value:  3.046053e+00","Date: 2018-09-30<br />.group_value:  2.774738e+00","Date: 2018-10-31<br />.group_value:  2.968905e+00","Date: 2018-11-30<br />.group_value:  2.881830e+00","Date: 2018-12-31<br />.group_value:  3.530947e+00","Date: 2019-01-31<br />.group_value:  2.633161e+00","Date: 2019-02-28<br />.group_value:  2.606719e+00","Date: 2019-03-31<br />.group_value:  2.798431e+00","Date: 2019-04-30<br />.group_value:  2.705816e+00","Date: 2019-05-31<br />.group_value:  2.713030e+00","Date: 2019-06-30<br />.group_value:  2.771226e+00","Date: 2019-07-31<br />.group_value:  2.640284e+00","Date: 2019-08-31<br />.group_value:  2.542031e+00","Date: 2019-09-30<br />.group_value:  2.502083e+00","Date: 2019-10-31<br />.group_value:  2.645900e+00","Date: 2019-11-30<br />.group_value:  2.739074e+00","Date: 2019-12-31<br />.group_value:  2.863159e+00","Date: 2020-01-31<br />.group_value:  2.523709e+00","Date: 2020-02-29<br />.group_value:  2.549524e+00","Date: 2020-03-31<br />.group_value:  2.579665e+00","Date: 2020-04-30<br />.group_value:  2.429303e+00","Date: 2020-05-31<br />.group_value:  2.305767e+00","Date: 2020-06-30<br />.group_value:  2.395021e+00","Date: 2020-07-31<br />.group_value:  2.396816e+00","Date: 2020-08-31<br />.group_value:  2.324648e+00","Date: 2020-09-30<br />.group_value:  2.357466e+00","Date: 2020-10-31<br />.group_value:  2.432687e+00","Date: 2020-11-30<br />.group_value:  2.379134e+00","Date: 2020-12-31<br />.group_value:  2.586472e+00","Date: 2021-01-31<br />.group_value:  2.211341e+00","Date: 2021-02-28<br />.group_value:  2.232371e+00","Date: 2021-03-31<br />.group_value:  2.380461e+00","Date: 2021-04-30<br />.group_value:  2.295105e+00","Date: 2021-05-31<br />.group_value:  2.280709e+00","Date: 2021-06-30<br />.group_value:  2.353383e+00","Date: 2021-07-31<br />.group_value:  2.254468e+00","Date: 2021-08-31<br />.group_value:  2.209467e+00","Date: 2021-09-30<br />.group_value:  2.298430e+00"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17197,17225,17256,17286,17317,17347,17378,17409,17439,17470,17500,17531,17562,17590,17621,17651,17682,17712,17743,17774,17804,17835,17865,17896,17927,17955,17986,18016,18047,18077,18108,18139,18169,18200,18230,18261,18292,18321,18352,18382,18413,18443,18474,18505,18535,18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[-0.130114767810285,-0.0798496414504053,0.0523538192384633,-0.0303524973984246,0.00262047486382138,0.0423032403615782,-0.0370688133230477,-0.0652864895943215,-0.0556737653462085,0.0121111101372241,0.0454544864775147,0.243502826108743,-0.130114767810285,-0.0798496414504053,0.0523538192384633,-0.0303524973984246,0.00262047486382138,0.0423032403615782,-0.0370688133230477,-0.0652864895943215,-0.0556737653462085,0.0121111101372241,0.0454544864775147,0.243502826108743,-0.130114767810285,-0.0798496414504053,0.0523538192384633,-0.0303524973984246,0.00262047486382138,0.0423032403615782,-0.0370688133230477,-0.0652864895943215,-0.0556737653462085,0.0121111101372241,0.0454544864775147,0.243502826108743,-0.130114767810285,-0.0798496414504053,0.0523538192384633,-0.0303524973984246,0.00262047486382138,0.0423032403615782,-0.0370688133230477,-0.0652864895943215,-0.0556737653462085,0.0121111101372241,0.0454544864775147,0.243502826108743,-0.130114767810285,-0.0798496414504053,0.0523538192384633,-0.0303524973984246,0.00262047486382138,0.0423032403615782,-0.0370688133230477,-0.0652864895943215,-0.0556737653462085],"text":["Date: 2017-01-31<br />.group_value: -1.301148e-01","Date: 2017-02-28<br />.group_value: -7.984964e-02","Date: 2017-03-31<br />.group_value:  5.235382e-02","Date: 2017-04-30<br />.group_value: -3.035250e-02","Date: 2017-05-31<br />.group_value:  2.620475e-03","Date: 2017-06-30<br />.group_value:  4.230324e-02","Date: 2017-07-31<br />.group_value: -3.706881e-02","Date: 2017-08-31<br />.group_value: -6.528649e-02","Date: 2017-09-30<br />.group_value: -5.567377e-02","Date: 2017-10-31<br />.group_value:  1.211111e-02","Date: 2017-11-30<br />.group_value:  4.545449e-02","Date: 2017-12-31<br />.group_value:  2.435028e-01","Date: 2018-01-31<br />.group_value: -1.301148e-01","Date: 2018-02-28<br />.group_value: -7.984964e-02","Date: 2018-03-31<br />.group_value:  5.235382e-02","Date: 2018-04-30<br />.group_value: -3.035250e-02","Date: 2018-05-31<br />.group_value:  2.620475e-03","Date: 2018-06-30<br />.group_value:  4.230324e-02","Date: 2018-07-31<br />.group_value: -3.706881e-02","Date: 2018-08-31<br />.group_value: -6.528649e-02","Date: 2018-09-30<br />.group_value: -5.567377e-02","Date: 2018-10-31<br />.group_value:  1.211111e-02","Date: 2018-11-30<br />.group_value:  4.545449e-02","Date: 2018-12-31<br />.group_value:  2.435028e-01","Date: 2019-01-31<br />.group_value: -1.301148e-01","Date: 2019-02-28<br />.group_value: -7.984964e-02","Date: 2019-03-31<br />.group_value:  5.235382e-02","Date: 2019-04-30<br />.group_value: -3.035250e-02","Date: 2019-05-31<br />.group_value:  2.620475e-03","Date: 2019-06-30<br />.group_value:  4.230324e-02","Date: 2019-07-31<br />.group_value: -3.706881e-02","Date: 2019-08-31<br />.group_value: -6.528649e-02","Date: 2019-09-30<br />.group_value: -5.567377e-02","Date: 2019-10-31<br />.group_value:  1.211111e-02","Date: 2019-11-30<br />.group_value:  4.545449e-02","Date: 2019-12-31<br />.group_value:  2.435028e-01","Date: 2020-01-31<br />.group_value: -1.301148e-01","Date: 2020-02-29<br />.group_value: -7.984964e-02","Date: 2020-03-31<br />.group_value:  5.235382e-02","Date: 2020-04-30<br />.group_value: -3.035250e-02","Date: 2020-05-31<br />.group_value:  2.620475e-03","Date: 2020-06-30<br />.group_value:  4.230324e-02","Date: 2020-07-31<br />.group_value: -3.706881e-02","Date: 2020-08-31<br />.group_value: -6.528649e-02","Date: 2020-09-30<br />.group_value: -5.567377e-02","Date: 2020-10-31<br />.group_value:  1.211111e-02","Date: 2020-11-30<br />.group_value:  4.545449e-02","Date: 2020-12-31<br />.group_value:  2.435028e-01","Date: 2021-01-31<br />.group_value: -1.301148e-01","Date: 2021-02-28<br />.group_value: -7.984964e-02","Date: 2021-03-31<br />.group_value:  5.235382e-02","Date: 2021-04-30<br />.group_value: -3.035250e-02","Date: 2021-05-31<br />.group_value:  2.620475e-03","Date: 2021-06-30<br />.group_value:  4.230324e-02","Date: 2021-07-31<br />.group_value: -3.706881e-02","Date: 2021-08-31<br />.group_value: -6.528649e-02","Date: 2021-09-30<br />.group_value: -5.567377e-02"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[17197,17225,17256,17286,17317,17347,17378,17409,17439,17470,17500,17531,17562,17590,17621,17651,17682,17712,17743,17774,17804,17835,17865,17896,17927,17955,17986,18016,18047,18077,18108,18139,18169,18200,18230,18261,18292,18321,18352,18382,18413,18443,18474,18505,18535,18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[3.61401320833881,3.60496163029474,3.59591005225067,3.58594942478176,3.57598879731286,3.56676673662628,3.5575446759397,3.53234235652101,3.50714003710232,3.47150447627525,3.43586891544817,3.40252678874353,3.36918466203889,3.34018243602851,3.31118021001813,3.26758106452356,3.223981919029,3.17263350269647,3.12128508636395,3.06065280382263,3.0000205212813,2.93904713358104,2.87807374588077,2.83589894390093,2.79372414192109,2.76643209024332,2.73914003856555,2.7205429145936,2.70194579062165,2.68640227019053,2.67085874975941,2.65952968166241,2.64820061356541,2.63758147812151,2.62696234267762,2.61068903862907,2.59441573458053,2.5615009845772,2.52858623457387,2.49703520859306,2.46548418261225,2.43975250229536,2.41402082197847,2.40046541971765,2.38691001745682,2.37688066250088,2.36685130754493,2.35416189204268,2.34147247654043,2.33054938526391,2.31962629398739,2.3156006102812,2.31157492657501,2.30913860608854,2.30670228560208,2.30466414958202,2.30262601356196],"text":["Date: 2017-01-31<br />.group_value:  3.614013e+00","Date: 2017-02-28<br />.group_value:  3.604962e+00","Date: 2017-03-31<br />.group_value:  3.595910e+00","Date: 2017-04-30<br />.group_value:  3.585949e+00","Date: 2017-05-31<br />.group_value:  3.575989e+00","Date: 2017-06-30<br />.group_value:  3.566767e+00","Date: 2017-07-31<br />.group_value:  3.557545e+00","Date: 2017-08-31<br />.group_value:  3.532342e+00","Date: 2017-09-30<br />.group_value:  3.507140e+00","Date: 2017-10-31<br />.group_value:  3.471504e+00","Date: 2017-11-30<br />.group_value:  3.435869e+00","Date: 2017-12-31<br />.group_value:  3.402527e+00","Date: 2018-01-31<br />.group_value:  3.369185e+00","Date: 2018-02-28<br />.group_value:  3.340182e+00","Date: 2018-03-31<br />.group_value:  3.311180e+00","Date: 2018-04-30<br />.group_value:  3.267581e+00","Date: 2018-05-31<br />.group_value:  3.223982e+00","Date: 2018-06-30<br />.group_value:  3.172634e+00","Date: 2018-07-31<br />.group_value:  3.121285e+00","Date: 2018-08-31<br />.group_value:  3.060653e+00","Date: 2018-09-30<br />.group_value:  3.000021e+00","Date: 2018-10-31<br />.group_value:  2.939047e+00","Date: 2018-11-30<br />.group_value:  2.878074e+00","Date: 2018-12-31<br />.group_value:  2.835899e+00","Date: 2019-01-31<br />.group_value:  2.793724e+00","Date: 2019-02-28<br />.group_value:  2.766432e+00","Date: 2019-03-31<br />.group_value:  2.739140e+00","Date: 2019-04-30<br />.group_value:  2.720543e+00","Date: 2019-05-31<br />.group_value:  2.701946e+00","Date: 2019-06-30<br />.group_value:  2.686402e+00","Date: 2019-07-31<br />.group_value:  2.670859e+00","Date: 2019-08-31<br />.group_value:  2.659530e+00","Date: 2019-09-30<br />.group_value:  2.648201e+00","Date: 2019-10-31<br />.group_value:  2.637581e+00","Date: 2019-11-30<br />.group_value:  2.626962e+00","Date: 2019-12-31<br />.group_value:  2.610689e+00","Date: 2020-01-31<br />.group_value:  2.594416e+00","Date: 2020-02-29<br />.group_value:  2.561501e+00","Date: 2020-03-31<br />.group_value:  2.528586e+00","Date: 2020-04-30<br />.group_value:  2.497035e+00","Date: 2020-05-31<br />.group_value:  2.465484e+00","Date: 2020-06-30<br />.group_value:  2.439753e+00","Date: 2020-07-31<br />.group_value:  2.414021e+00","Date: 2020-08-31<br />.group_value:  2.400465e+00","Date: 2020-09-30<br />.group_value:  2.386910e+00","Date: 2020-10-31<br />.group_value:  2.376881e+00","Date: 2020-11-30<br />.group_value:  2.366851e+00","Date: 2020-12-31<br />.group_value:  2.354162e+00","Date: 2021-01-31<br />.group_value:  2.341472e+00","Date: 2021-02-28<br />.group_value:  2.330549e+00","Date: 2021-03-31<br />.group_value:  2.319626e+00","Date: 2021-04-30<br />.group_value:  2.315601e+00","Date: 2021-05-31<br />.group_value:  2.311575e+00","Date: 2021-06-30<br />.group_value:  2.309139e+00","Date: 2021-07-31<br />.group_value:  2.306702e+00","Date: 2021-08-31<br />.group_value:  2.304664e+00","Date: 2021-09-30<br />.group_value:  2.302626e+00"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[17197,17225,17256,17286,17317,17347,17378,17409,17439,17470,17500,17531,17562,17590,17621,17651,17682,17712,17743,17774,17804,17835,17865,17896,17927,17955,17986,18016,18047,18077,18108,18139,18169,18200,18230,18261,18292,18321,18352,18382,18413,18443,18474,18505,18535,18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[-0.046415036729186,0.0318394549963195,1.05420990131429,0.00646736806049475,0.260789615033858,0.196199333857507,-0.00500190951364177,0.0365957325361648,0.0411947432130462,-0.0721712115206539,0.00985936325145031,0.909021227840216,0.0134047394846557,-0.213089771197311,-0.0185923695345238,-0.317232595606986,0.0594286273292468,0.256693842046895,-0.22167134379195,0.0506864669205842,-0.169608703212697,0.0177467466619095,-0.0416978022734544,0.451545065738244,-0.0304487039326733,-0.0798630615443763,0.00693747585637672,0.0156251952212765,0.00846372207541801,0.0425200441229054,0.00649407131677693,-0.0522126393374127,-0.0904437143480084,-0.00379296276383467,0.0666571282963493,0.00896724712795649,0.0594084636384493,0.0678723909819574,-0.00127536489316826,-0.0373797640686915,-0.162337804866623,-0.0870350889815605,0.0198635383564469,-0.0105305095080657,0.0262298315939615,0.0436949596644434,-0.0331718449298073,-0.0111926413314034,-1.69135908487661e-05,-0.0183287438719235,0.00848129603295256,0.00985689901475428,-0.0334866620679839,0.00194118242368635,-0.0151658581416099,-0.0299102174636543,0.0514772793584535],"text":["Date: 2017-01-31<br />.group_value: -4.641504e-02","Date: 2017-02-28<br />.group_value:  3.183945e-02","Date: 2017-03-31<br />.group_value:  1.054210e+00","Date: 2017-04-30<br />.group_value:  6.467368e-03","Date: 2017-05-31<br />.group_value:  2.607896e-01","Date: 2017-06-30<br />.group_value:  1.961993e-01","Date: 2017-07-31<br />.group_value: -5.001910e-03","Date: 2017-08-31<br />.group_value:  3.659573e-02","Date: 2017-09-30<br />.group_value:  4.119474e-02","Date: 2017-10-31<br />.group_value: -7.217121e-02","Date: 2017-11-30<br />.group_value:  9.859363e-03","Date: 2017-12-31<br />.group_value:  9.090212e-01","Date: 2018-01-31<br />.group_value:  1.340474e-02","Date: 2018-02-28<br />.group_value: -2.130898e-01","Date: 2018-03-31<br />.group_value: -1.859237e-02","Date: 2018-04-30<br />.group_value: -3.172326e-01","Date: 2018-05-31<br />.group_value:  5.942863e-02","Date: 2018-06-30<br />.group_value:  2.566938e-01","Date: 2018-07-31<br />.group_value: -2.216713e-01","Date: 2018-08-31<br />.group_value:  5.068647e-02","Date: 2018-09-30<br />.group_value: -1.696087e-01","Date: 2018-10-31<br />.group_value:  1.774675e-02","Date: 2018-11-30<br />.group_value: -4.169780e-02","Date: 2018-12-31<br />.group_value:  4.515451e-01","Date: 2019-01-31<br />.group_value: -3.044870e-02","Date: 2019-02-28<br />.group_value: -7.986306e-02","Date: 2019-03-31<br />.group_value:  6.937476e-03","Date: 2019-04-30<br />.group_value:  1.562520e-02","Date: 2019-05-31<br />.group_value:  8.463722e-03","Date: 2019-06-30<br />.group_value:  4.252004e-02","Date: 2019-07-31<br />.group_value:  6.494071e-03","Date: 2019-08-31<br />.group_value: -5.221264e-02","Date: 2019-09-30<br />.group_value: -9.044371e-02","Date: 2019-10-31<br />.group_value: -3.792963e-03","Date: 2019-11-30<br />.group_value:  6.665713e-02","Date: 2019-12-31<br />.group_value:  8.967247e-03","Date: 2020-01-31<br />.group_value:  5.940846e-02","Date: 2020-02-29<br />.group_value:  6.787239e-02","Date: 2020-03-31<br />.group_value: -1.275365e-03","Date: 2020-04-30<br />.group_value: -3.737976e-02","Date: 2020-05-31<br />.group_value: -1.623378e-01","Date: 2020-06-30<br />.group_value: -8.703509e-02","Date: 2020-07-31<br />.group_value:  1.986354e-02","Date: 2020-08-31<br />.group_value: -1.053051e-02","Date: 2020-09-30<br />.group_value:  2.622983e-02","Date: 2020-10-31<br />.group_value:  4.369496e-02","Date: 2020-11-30<br />.group_value: -3.317184e-02","Date: 2020-12-31<br />.group_value: -1.119264e-02","Date: 2021-01-31<br />.group_value: -1.691359e-05","Date: 2021-02-28<br />.group_value: -1.832874e-02","Date: 2021-03-31<br />.group_value:  8.481296e-03","Date: 2021-04-30<br />.group_value:  9.856899e-03","Date: 2021-05-31<br />.group_value: -3.348666e-02","Date: 2021-06-30<br />.group_value:  1.941182e-03","Date: 2021-07-31<br />.group_value: -1.516586e-02","Date: 2021-08-31<br />.group_value: -2.991022e-02","Date: 2021-09-30<br />.group_value:  5.147728e-02"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":55.4520547945205,"r":7.30593607305936,"b":25.5707762557078,"l":16.8036529680365},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"STL Diagnostics","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[17111.85,18985.15],"tickmode":"array","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"yaxis":{"domain":[0.812556178765326,1],"automargin":true,"type":"linear","autorange":false,"range":[2.08481712601008,4.8271240893174],"tickmode":"array","ticktext":["3","4"],"tickvals":[3,4],"categoryorder":"array","categoryarray":["3","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.812556178765326,"y1":1},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.562556178765326,"y1":0.687443821234674},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":0.687443821234674,"ysizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.312556178765326,"y1":0.437443821234674},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":0.437443821234674,"ysizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.187443821234674},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":0.187443821234674,"ysizemode":"pixel"}],"annotations":[{"text":"observed","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"season","x":0.5,"y":0.687443821234674,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"trend","x":0.5,"y":0.437443821234674,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"remainder","x":0.5,"y":0.187443821234674,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis2":{"type":"linear","autorange":false,"range":[-0.148795647506237,0.262183705804694],"tickmode":"array","ticktext":["-0.1","0.0","0.1","0.2"],"tickvals":[-0.1,0,0.1,0.2],"categoryorder":"array","categoryarray":["-0.1","0.0","0.1","0.2"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.562556178765326,0.687443821234674],"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[2.23705665382312,3.67958256807765],"tickmode":"array","ticktext":["2.4","2.8","3.2","3.6"],"tickvals":[2.4,2.8,3.2,3.6],"categoryorder":"array","categoryarray":["2.4","2.8","3.2","3.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.312556178765326,0.437443821234674],"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.38580472045305,1.12278202616036],"tickmode":"array","ticktext":["0.0","0.4","0.8"],"tickvals":[0,0.4,0.8],"categoryorder":"array","categoryarray":["0.0","0.4","0.8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.187443821234674],"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4907cb7ade0":{"x":{},"y":{},"type":"scatter"}},"cur_data":"4907cb7ade0","visdat":{"4907cb7ade0":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

It's evident that seasonality is present in our data. Since the data is presented in a monthly basis, we need somehow to capture the **monthly seasonality** and assess it in our future models.

As previously stated, our trend has shown a strong decrease during the first 3 years, but it seems to be stabilized during the last 2 years. Also, after removing the trend/seasonality we can see in our **remainder** that errors are still present. Again, our goal is be able to capture these variations/errors through statistical models.

More importantly, a better way to understand the seasonality is to plot the actual values, using an STL (seasonal & trend decomposition) diagnostics.

**Yearly Seasonality:**



```r
## YEARLY SEASONALITY

fin_data_ac_rev_bus %>% 

  plot_seasonal_diagnostics(Date, log_interval_vec(Value, offset = 1000000),
                            .feature_set = "year") 
```

```{=html}
<div id="htmlwidget-71ed1ef04008c62511b7" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-71ed1ef04008c62511b7">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5],"y":[3.43748340379934,3.55695144384066,4.70247377280343,3.56206429544383,3.83939888721053,3.80526931084536,3.51547395310301,3.50365159946285,3.49266101496916,3.41144437489182,3.49118276517713,4.55505084269249,3.25247463371326,3.04724302338079,3.34494165972207,2.91999597151815,3.28603102122207,3.47163058510495,2.86254492924895,3.04605278114889,2.7747380527224,2.96890499038017,2.88183043008483,3.53094683574792,2.63316067017813,2.60671938724854,2.79843133366039,2.70581561241646,2.71302998756089,2.77122555467501,2.64028400775314,2.54203055273068,2.5020831338712,2.6458996254949,2.73907395745148,2.86315911186577,2.5237094304087,2.54952373410875,2.57966468891916,2.42930294712594,2.30576685260945,2.39502065367538,2.39681554701187,2.32464842061526,2.35746608370458,2.43268673230254,2.37913394909263,2.58647207682002,2.2113407951393,2.23237099994159,2.38046140925881,2.29510501189753,2.28070873937084,2.35338302887381,2.25446761413742,2.20946744252404,2.29842952757421],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(44,62,80,1)","width":1.88976377952756},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":55.4520547945205,"r":7.30593607305936,"b":25.5707762557078,"l":16.8036529680365},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Seasonal Diagnostics","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,5.6],"tickmode":"array","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.08481712601008,4.8271240893174],"tickmode":"array","ticktext":["3","4"],"tickvals":[3,4],"categoryorder":"array","categoryarray":["3","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":1,"ysizemode":"pixel"}],"annotations":[{"text":"year","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4903e7a3d15":{"x":{},"y":{},"type":"box"}},"cur_data":"4903e7a3d15","visdat":{"4903e7a3d15":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```


**Monthly Seasonality:**


```r
## MONTHLY SEASONALITY

fin_data_ac_rev_bus %>% 

  plot_seasonal_diagnostics(Date, log_interval_vec(Value, offset = 1000000),
                            .feature_set = "month.lbl") 
```

```{=html}
<div id="htmlwidget-2b7ec8dfd78766587784" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2b7ec8dfd78766587784">{"x":{"data":[{"x":[1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12],"y":[3.43748340379934,2.2113407951393,2.5237094304087,2.63316067017813,3.25247463371326,3.55695144384066,2.23237099994159,2.54952373410875,3.04724302338079,2.60671938724854,4.70247377280343,3.34494165972207,2.79843133366039,2.38046140925881,2.57966468891916,3.56206429544383,2.91999597151815,2.70581561241646,2.42930294712594,2.29510501189753,3.83939888721053,3.28603102122207,2.71302998756089,2.30576685260945,2.28070873937084,3.80526931084536,3.47163058510495,2.77122555467501,2.39502065367538,2.35338302887381,3.51547395310301,2.86254492924895,2.64028400775314,2.39681554701187,2.25446761413742,3.50365159946285,3.04605278114889,2.54203055273068,2.32464842061526,2.20946744252404,3.49266101496916,2.7747380527224,2.5020831338712,2.35746608370458,2.29842952757421,2.96890499038017,3.41144437489182,2.6458996254949,2.43268673230254,2.73907395745148,2.37913394909263,2.88183043008483,3.49118276517713,3.53094683574792,4.55505084269249,2.58647207682002,2.86315911186577],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(44,62,80,1)","width":1.88976377952756},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":55.4520547945205,"r":7.30593607305936,"b":25.5707762557078,"l":16.8036529680365},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Seasonal Diagnostics","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,12.6],"tickmode":"array","ticktext":["January","February","March","April","May","June","July","August","September","October","November","December"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"categoryorder":"array","categoryarray":["January","February","March","April","May","June","July","August","September","October","November","December"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.08481712601008,4.8271240893174],"tickmode":"array","ticktext":["3","4"],"tickvals":[3,4],"categoryorder":"array","categoryarray":["3","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":1,"ysizemode":"pixel"}],"annotations":[{"text":"month.lbl","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"490bf8580d":{"x":{},"y":{},"type":"box"}},"cur_data":"490bf8580d","visdat":{"490bf8580d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

Clearly, we can spot some seasonality on a monthly basis. As we can see on the previous graph, there is quite a lot of opportunity in our commercial business during the last quarter of the year. We usually call it, "the busy months" since we are collecting most of the revenue during this period.


### 4. Data preparation (phase 1): Transformation / Feature Engineering

Next steps are to normalize and transform our data in order to facilitate the models to capture the variations (specially the sequential models). Basic transformations are used: **logarithm (base 10) & normalization transformation** (centralize the data to the mean and make it comparable).

**Feature Engineering** consists in adding “additional features” to the model and be able to make accurate models. For instance, we add Fourier Terms (i.e., monthly & yearly) in order to capture seasonality more accurate.



```r
# Activating Parallel Processing (for fast computing)

registerDoFuture()
n_cores <- parallel::detectCores()
plan(
  strategy = cluster,
  workers  = parallel::makeCluster(n_cores)
)

# DATA PREPARATION: TRANSFORMATIONS / FEATURE ENGINEERING

full_data_tbl <- fin_data_ac_rev_bus %>%

  # 1. Log transformation  
  mutate(value_trans = Value %>% log_interval_vec(offset = 1000000) )  %>%
  # 2. Standard normalization
  mutate(value_trans = standardize_vec(value_trans)) %>%
  
  # 3. Creating future frame: we are going to asses the last 2 months (available)
  future_frame(Date, .length_out = 2, .bind_data = TRUE) %>% 
  
  # 4. Foutier series: including monthly / yearly seasonality. Order 2.
  tk_augment_fourier(Date, .periods = c(30, 365), .K = 2) %>%
  
  rowid_to_column(var = "rowid") # create rowid to keep track of our values

# DATA PREPARATION: Creating two sets: The data to train the model and data to be assessed (3 months)

# train data
data_prepared_tbl <- full_data_tbl %>%
  filter(!is.na(Value)) 

# Future data (future data corresponds to unseen data, that means: October, November and December 2021)
future_tbl <- full_data_tbl %>%
  filter(is.na(Value))
```

How the data looks like (after the transformation steps):


```r
data_prepared_tbl %>% head(5)
```

```
## # A tibble: 5 × 12
##   rowid Date         Value value_trans Date_sin30_K1 Date_cos30_K1 Date_sin30_K2
##   <int> <date>       <dbl>       <dbl>         <dbl>         <dbl>         <dbl>
## 1     1 2017-01-31 283845.       0.965        0.0540        -0.999        -0.108
## 2     2 2017-02-28 288364.       1.17        -0.135         -0.991         0.267
## 3     3 2017-03-31 313201.       3.16        -0.338         -0.941         0.636
## 4     4 2017-04-30 288546.       1.18        -0.520         -0.854         0.889
## 5     5 2017-05-31 297216.       1.66        -0.687         -0.727         0.998
## # … with 5 more variables: Date_cos30_K2 <dbl>, Date_sin365_K1 <dbl>,
## #   Date_cos365_K1 <dbl>, Date_sin365_K2 <dbl>, Date_cos365_K2 <dbl>
```


**value_trans:** the actual values already transformed

**Date_sin & Date_cos features:** the fourier series features created to assess seasonality


### 5. Data splitting (train / test)

Before training a model, we need to split the data into two parts:

1. **Training set:** The data that is going to be used to train our models.
2. **Testing set:** Corresponds to the last 12 point values of our data. This is fixed number, and depending on the size of the data we may choose a greater a value. 


```r
# TIME SPLIT

splits <- time_series_split(data_prepared_tbl, assess = 12, skip = 12, cumulative = TRUE)

splits %>%
  tk_time_series_cv_plan() %>%
  plot_time_series_cv_plan(Date, value_trans)
```

```{=html}
<div id="htmlwidget-9cd7d141dfafdabb660b" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9cd7d141dfafdabb660b">{"x":{"data":[{"x":["2017-01-31","2017-02-28","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31","2020-09-30"],"y":[0.964781079964261,1.17177550390611,3.15654678260268,1.18063420596512,1.6611536322656,1.60201955760727,1.09991018077179,1.0794263653469,1.06038370167493,0.919664965337671,1.05782243538114,2.90111675727054,0.644228539092953,0.288637211565227,0.804440079984477,0.0681646049208326,0.702369487078316,1.02394565754625,-0.0313770414915346,0.286574957048802,-0.183514247546497,0.152906048585631,0.00203767875140619,1.12671902796385,-0.428816076661721,-0.474629150404296,-0.142462456311306,-0.302931631667477,-0.290431757838402,-0.18960012214244,-0.416473937648038,-0.586711243923733,-0.655925512040311,-0.406744125732374,-0.245307082295081,-0.0303128876231043,-0.618455048875206,-0.573728300851174,-0.521505048708756,-0.782026959963158,-0.996069834623397,-0.841425637481853,-0.838315743722012,-0.963354982256761,-0.906493973538938],"text":[".color_mod: training<br />.color_mod: training<br />Date: 2017-01-31<br />.value:  0.964781080",".color_mod: training<br />.color_mod: training<br />Date: 2017-02-28<br />.value:  1.171775504",".color_mod: training<br />.color_mod: training<br />Date: 2017-03-31<br />.value:  3.156546783",".color_mod: training<br />.color_mod: training<br />Date: 2017-04-30<br />.value:  1.180634206",".color_mod: training<br />.color_mod: training<br />Date: 2017-05-31<br />.value:  1.661153632",".color_mod: training<br />.color_mod: training<br />Date: 2017-06-30<br />.value:  1.602019558",".color_mod: training<br />.color_mod: training<br />Date: 2017-07-31<br />.value:  1.099910181",".color_mod: training<br />.color_mod: training<br />Date: 2017-08-31<br />.value:  1.079426365",".color_mod: training<br />.color_mod: training<br />Date: 2017-09-30<br />.value:  1.060383702",".color_mod: training<br />.color_mod: training<br />Date: 2017-10-31<br />.value:  0.919664965",".color_mod: training<br />.color_mod: training<br />Date: 2017-11-30<br />.value:  1.057822435",".color_mod: training<br />.color_mod: training<br />Date: 2017-12-31<br />.value:  2.901116757",".color_mod: training<br />.color_mod: training<br />Date: 2018-01-31<br />.value:  0.644228539",".color_mod: training<br />.color_mod: training<br />Date: 2018-02-28<br />.value:  0.288637212",".color_mod: training<br />.color_mod: training<br />Date: 2018-03-31<br />.value:  0.804440080",".color_mod: training<br />.color_mod: training<br />Date: 2018-04-30<br />.value:  0.068164605",".color_mod: training<br />.color_mod: training<br />Date: 2018-05-31<br />.value:  0.702369487",".color_mod: training<br />.color_mod: training<br />Date: 2018-06-30<br />.value:  1.023945658",".color_mod: training<br />.color_mod: training<br />Date: 2018-07-31<br />.value: -0.031377041",".color_mod: training<br />.color_mod: training<br />Date: 2018-08-31<br />.value:  0.286574957",".color_mod: training<br />.color_mod: training<br />Date: 2018-09-30<br />.value: -0.183514248",".color_mod: training<br />.color_mod: training<br />Date: 2018-10-31<br />.value:  0.152906049",".color_mod: training<br />.color_mod: training<br />Date: 2018-11-30<br />.value:  0.002037679",".color_mod: training<br />.color_mod: training<br />Date: 2018-12-31<br />.value:  1.126719028",".color_mod: training<br />.color_mod: training<br />Date: 2019-01-31<br />.value: -0.428816077",".color_mod: training<br />.color_mod: training<br />Date: 2019-02-28<br />.value: -0.474629150",".color_mod: training<br />.color_mod: training<br />Date: 2019-03-31<br />.value: -0.142462456",".color_mod: training<br />.color_mod: training<br />Date: 2019-04-30<br />.value: -0.302931632",".color_mod: training<br />.color_mod: training<br />Date: 2019-05-31<br />.value: -0.290431758",".color_mod: training<br />.color_mod: training<br />Date: 2019-06-30<br />.value: -0.189600122",".color_mod: training<br />.color_mod: training<br />Date: 2019-07-31<br />.value: -0.416473938",".color_mod: training<br />.color_mod: training<br />Date: 2019-08-31<br />.value: -0.586711244",".color_mod: training<br />.color_mod: training<br />Date: 2019-09-30<br />.value: -0.655925512",".color_mod: training<br />.color_mod: training<br />Date: 2019-10-31<br />.value: -0.406744126",".color_mod: training<br />.color_mod: training<br />Date: 2019-11-30<br />.value: -0.245307082",".color_mod: training<br />.color_mod: training<br />Date: 2019-12-31<br />.value: -0.030312888",".color_mod: training<br />.color_mod: training<br />Date: 2020-01-31<br />.value: -0.618455049",".color_mod: training<br />.color_mod: training<br />Date: 2020-02-29<br />.value: -0.573728301",".color_mod: training<br />.color_mod: training<br />Date: 2020-03-31<br />.value: -0.521505049",".color_mod: training<br />.color_mod: training<br />Date: 2020-04-30<br />.value: -0.782026960",".color_mod: training<br />.color_mod: training<br />Date: 2020-05-31<br />.value: -0.996069835",".color_mod: training<br />.color_mod: training<br />Date: 2020-06-30<br />.value: -0.841425637",".color_mod: training<br />.color_mod: training<br />Date: 2020-07-31<br />.value: -0.838315744",".color_mod: training<br />.color_mod: training<br />Date: 2020-08-31<br />.value: -0.963354982",".color_mod: training<br />.color_mod: training<br />Date: 2020-09-30<br />.value: -0.906493974"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"training","legendgroup":"training","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[-0.77616409770199,-0.868951486757543,-0.509710334937613,-1.15967566061982,-1.12323800644115,-0.866651483741603,-1.01454290554311,-1.0394863811165,-0.913568414387942,-1.08495265476928,-1.1629214956172,-1.00878273565046],"text":[".color_mod: testing<br />.color_mod: testing<br />Date: 2020-10-31<br />.value: -0.776164098",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-11-30<br />.value: -0.868951487",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-12-31<br />.value: -0.509710335",".color_mod: testing<br />.color_mod: testing<br />Date: 2021-01-31<br />.value: -1.159675661",".color_mod: testing<br />.color_mod: testing<br />Date: 2021-02-28<br />.value: -1.123238006",".color_mod: testing<br />.color_mod: testing<br />Date: 2021-03-31<br />.value: -0.866651484",".color_mod: testing<br />.color_mod: testing<br />Date: 2021-04-30<br />.value: -1.014542906",".color_mod: testing<br />.color_mod: testing<br />Date: 2021-05-31<br />.value: -1.039486381",".color_mod: testing<br />.color_mod: testing<br />Date: 2021-06-30<br />.value: -0.913568414",".color_mod: testing<br />.color_mod: testing<br />Date: 2021-07-31<br />.value: -1.084952655",".color_mod: testing<br />.color_mod: testing<br />Date: 2021-08-31<br />.value: -1.162921496",".color_mod: testing<br />.color_mod: testing<br />Date: 2021-09-30<br />.value: -1.008782736"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"testing","legendgroup":"testing","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":55.4520547945205,"r":7.30593607305936,"b":25.5707762557078,"l":22.648401826484},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Time Series Cross Validation Plan","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["2016-11-06","2021-12-24"],"tickmode":"auto","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[-1.37889490952819,3.37252019651367],"tickmode":"auto","ticktext":["-1","0","1","2","3"],"tickvals":[-1,0,1,2,3],"categoryorder":"array","categoryarray":["-1","0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":1,"ysizemode":"pixel"}],"annotations":[{"text":"Slice1","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Legend","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"y":0.93503937007874},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"49029e47d9b":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"49029e47d9b","visdat":{"49029e47d9b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

```r
# New cleaned version of the data:

train_cleaned <- training(splits) 
```


### 6. Data preparation (Phase 2): "The Recipe"


To be more concise, we divided up the "data preparation steps" into 2 portions. The last portion consists in creating a “recipe”; this term is used by the “Tidymodels” package, which means to prepare the data and have it ready for forecasting models.

Our main additional points in this phase, consist in adding two **feature engineering** steps:

**1. Creating Time Series Signature:** In short, this step adds 12 additional variables, that correspond to the binary features per each month (i.e. Date_month.lbl_12 = 1, which means that this data point corresponds the month of December).

**2. Natural Splines:** Splines are continuos and smooth curves, that are added to tour time series with the goal to capture the non-linearity in our series. Splines are usually defined as piecewise polynomials of **degree n** with function values and first n-1 derivatives that agree at the points where they join. The abscissa values of the join points are called knots




```r
train_cleaned$Value <- NULL


recipe_spec <- recipe(value_trans ~ ., data = train_cleaned) %>%  
  update_role(rowid, new_role = "indicator") %>%
  # 1. Time series signature: Adding additional terms (monthly features) 
  step_timeseries_signature(Date) %>% 
  step_rm(matches("(.xts$)|(.iso$)|(hour)|(minute)|(second)|(am.pm)|(week)|(mday)|(day)|(half)|(quarter)")) %>% 
  
  step_rm(ends_with('Date_month')) %>% 
  step_normalize(Date_index.num, Date_year) %>% #normalizing index value
  # 2. Adding natural splines features
  step_ns(ends_with("index.num"), deg_free = 3) %>%
  # convert all categorical features to factors
  step_dummy(all_nominal(), one_hot = TRUE)

# since this is a recipe, we display it by
recipe_spec %>% prep() %>% juice %>% glimpse()
```

```
## Rows: 45
## Columns: 27
## $ rowid               <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ Date                <date> 2017-01-31, 2017-02-28, 2017-03-31, 2017-04-30, 2…
## $ Date_sin30_K1       <dbl> 0.05402259, -0.13471146, -0.33778424, -0.52033669,…
## $ Date_cos30_K1       <dbl> -0.99853971, -0.99088487, -0.94122357, -0.85396120…
## $ Date_sin30_K2       <dbl> -0.10788741, 0.26696710, 0.63586098, 0.88869469, 0…
## $ Date_cos30_K2       <dbl> 0.9941631, 0.9637056, 0.7718036, 0.4584995, 0.0573…
## $ Date_sin365_K1      <dbl> -0.1243415, -0.1397535, -0.1567772, -0.1732076, -0…
## $ Date_cos365_K1      <dbl> -0.9922395, -0.9901863, -0.9876340, -0.9848853, -0…
## $ Date_sin365_K2      <dbl> 0.2467531, 0.2767640, 0.3096771, 0.3411793, 0.3733…
## $ Date_cos365_K2      <dbl> 0.9690784, 0.9609379, 0.9508418, 0.9399982, 0.9276…
## $ value_trans         <dbl> 0.964781080, 1.171775504, 3.156546783, 1.180634206…
## $ Date_year           <dbl> -1.2780193, -1.2780193, -1.2780193, -1.2780193, -1…
## $ Date_index.num_ns_1 <dbl> 0.000000000, -0.015921599, -0.033116819, -0.048882…
## $ Date_index.num_ns_2 <dbl> 0.00000000, 0.04784176, 0.10041556, 0.15049620, 0.…
## $ Date_index.num_ns_3 <dbl> 0.00000000, -0.03187866, -0.06691044, -0.10028094,…
## $ Date_month.lbl_01   <dbl> 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,…
## $ Date_month.lbl_02   <dbl> 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,…
## $ Date_month.lbl_03   <dbl> 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
## $ Date_month.lbl_04   <dbl> 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,…
## $ Date_month.lbl_05   <dbl> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,…
## $ Date_month.lbl_06   <dbl> 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Date_month.lbl_07   <dbl> 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Date_month.lbl_08   <dbl> 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Date_month.lbl_09   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Date_month.lbl_10   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,…
## $ Date_month.lbl_11   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,…
## $ Date_month.lbl_12   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,…
```


### 7. Modelling Stage 1 (Sequential models)


We tested out several models during our training stage and finally come up with 4 models:

**Sequential**: It includes ARIMA and some of its variants

**Non-Sequential**: it includes Neural Network Model

Here, when we say **Sequential**, it means that the model considers the order of the data (otherwise, wrong results will be delivered). For **Non-Sequential models** we have included the best option, which is the NEURAL NETWORK model. This machine learning algorithm doesn’t necessary consider the order of the upcoming data.

*Model description summary:*

**1. ARIMA + EXTERNAL REGRESSORS:** ARIMA means “Auto-Regressive + Integrated + Moving Average”. In general terms, this model considers each lag sequentially (monthly data) by providing a weight to each lag (according to their importance). This algorithm also includes an integrated part which basically takes a “derivate” to the original time series and make it more stationary (more efficient to predict). Finally, it includes the Moving Average (MA) part, that simply takes the average of our errors to continuously improve the accuracy. The term EXTERNAL REGRESSORS, means that it includes the additional features that we added previously in the feature engineering stage.

So, ARIMA (1,1,1)(2,1,0)[12] means:  “1” AR component, “1” derivative, “1” MA component. Same logic applies to the seasonal component (2,1,0). Finally, “[12]” means the period of our data. 

**2. ARIMA + SLT:** Though this variant doesn’t include the "external regressors" part, it has the capability to include a seasonal pattern (STL). This has the benefit to capture our monthly seasonality more efficiently.

**3. XGBOOST ARIMA + EXTERNAL REGRESSORS:** Apart from adding the ARIMA capabilities, this model also includes an **eXtreme Gradient Boosting** which implements the called “gradient boosting decision tree algorithm”. Boosting is an ensemble technique where new models are added to correct the errors made by existing models. 


Each model is composed with a RECIPE (preparing our data for modeling) + MODEL SPECIFICATION (Parameters and configurations made in our models) and finally creating a **WORKFLOW**. This workflow contains all the information from the model, and we can use this stored object to make predictions, compare models and be able to calculate metrics on them.


```r
################################ 1. ARIMA + EXTERNAL REGRESSORS #########################################

# RECIPE
recipe_arima <- recipe_spec %>%
  step_rm(ends_with('rowid')) %>%
  step_rm(matches("(Date_month.lbl)")) %>%
  step_rm(contains('Date_sin')) %>%
  step_rm(contains('Date_year')) %>%
  step_rm(contains('Date_cos')) 

# MODEL SPEC

model_spec_arima <- arima_reg(
  mode = "regression",
  seasonal_period = 12,
  non_seasonal_ar = 1,
  non_seasonal_differences = 1,
  non_seasonal_ma = 1,
  seasonal_ar = 2,
  seasonal_differences = 1,
  seasonal_ma = 0
)  %>%
  set_engine("arima")

# WORKFLOW
workflow_fit_arima <- workflow() %>%
  add_model(model_spec_arima) %>%
  add_recipe(recipe_arima)  %>% 
  fit(training(splits))


################################ 2. ARIMA + STL (Seasonal) #########################################

# MODEL SPEC
model_spec_arima_STL <-  seasonal_reg(
  seasonal_period_1 = 12) %>%
  set_engine("stlm_arima") 

# WORKFLOW
workflow_fit_arima_STL <- workflow() %>%
  add_model(model_spec_arima_STL) %>%
  add_recipe(recipe_arima)  %>% 
  fit(training(splits))

################################# 3. ARIMA + XGBOOST #############################################

# MODEL SPEC

# arima parameters
model_arima_boost <- arima_boost(
  seasonal_period = 12,  
  non_seasonal_ar = 1,
  non_seasonal_differences = 1,
  non_seasonal_ma = 2,
  seasonal_ar = 2,
  seasonal_differences = 1,
  seasonal_ma = 0,

# xgboost parameters  
  mtry = 20,
  min_n = 1,
  tree_depth = 3,
  learn_rate = 0.25,
  trees = 15

) %>%
  set_engine("arima_xgboost")

# WORKFLOW
workflow_fit_arima_XG <- workflow() %>%
  add_model(model_arima_boost) %>%
  add_recipe(recipe_arima)  %>% 
  fit(training(splits))
```

Now, we combine all models into one single table:


```r
submodels_1_tbl <- modeltime_table(
  
  workflow_fit_arima,
  workflow_fit_arima_STL,
  workflow_fit_arima_XG
)

submodels_1_tbl %>%
  modeltime_accuracy(testing(splits)) %>%
  arrange(rmse)
```

```
## # A tibble: 3 × 9
##   .model_id .model_desc                .type   mae  mape  mase smape  rmse   rsq
##       <int> <chr>                      <chr> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
## 1         3 ARIMA(1,1,2)(2,1,0)[12] W… Test  0.114  12.0 0.599  12.5 0.143 0.541
## 2         1 REGRESSION WITH ARIMA(1,1… Test  0.188  19.4 0.989  19.8 0.223 0.461
## 3         2 SEASONAL DECOMP: REGRESSI… Test  0.186  25.9 0.973  29.6 0.283 0.827
```

### 8. Modelling Stage 2 (Non-Sequential models)


**4. NEURAL NETWORK: ** This algorithm basically simulates “a brain network” where one can provide several neurons that "continuously learn" according to several iterations or epochs during the training stage. This is a black box model, which it can be difficult to understand but in exchange it provided greater results. Our model was trained using a method called “Hyper-parameter tuning” which basically finds the best parameters that provide better results. Our final version was: [24-5-1] Neural Network, which means: “24” inputs, “5” deep layers and “1” single output.

This stage also includes a sampling technique called: **V-fold cross-validation** (also known as k-fold cross-validation) which randomly splits the data into V groups of roughly equal size (called “folds”). A resample of the analysis, consisted of V-1 of the folds while the assessment set contains the final fold. In basic V-fold cross-validation (i.e. no repeats), the number of resamples is equal to V.



```r
################################# 4. NEURAL NETWORK #############################################

# K-FOLD Cross-Validation

set.seed(123)
resamples_kfold <- train_cleaned %>% vfold_cv(v = 5)  
resamples_kfold %>%
  tk_time_series_cv_plan() %>%
  plot_time_series_cv_plan(Date, value_trans, .facet_ncol = 2)
```

```{=html}
<div id="htmlwidget-e79d2a5e6c58c2b514c2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e79d2a5e6c58c2b514c2">{"x":{"data":[{"x":["2017-02-28","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-09-30","2017-10-31","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2020-02-29","2020-03-31","2020-06-30","2020-07-31","2020-09-30"],"y":[1.17177550390611,3.15654678260268,1.18063420596512,1.6611536322656,1.60201955760727,1.09991018077179,1.06038370167493,0.919664965337671,2.90111675727054,0.644228539092953,0.288637211565227,0.804440079984477,0.0681646049208326,0.702369487078316,1.02394565754625,-0.0313770414915346,0.286574957048802,-0.183514247546497,0.152906048585631,0.00203767875140619,1.12671902796385,-0.474629150404296,-0.142462456311306,-0.302931631667477,-0.290431757838402,-0.18960012214244,-0.416473937648038,-0.586711243923733,-0.655925512040311,-0.406744125732374,-0.245307082295081,-0.573728300851174,-0.521505048708756,-0.841425637481853,-0.838315743722012,-0.906493973538938],"text":[".color_mod: training<br />.color_mod: training<br />Date: 2017-02-28<br />.value:  1.171775504",".color_mod: training<br />.color_mod: training<br />Date: 2017-03-31<br />.value:  3.156546783",".color_mod: training<br />.color_mod: training<br />Date: 2017-04-30<br />.value:  1.180634206",".color_mod: training<br />.color_mod: training<br />Date: 2017-05-31<br />.value:  1.661153632",".color_mod: training<br />.color_mod: training<br />Date: 2017-06-30<br />.value:  1.602019558",".color_mod: training<br />.color_mod: training<br />Date: 2017-07-31<br />.value:  1.099910181",".color_mod: training<br />.color_mod: training<br />Date: 2017-09-30<br />.value:  1.060383702",".color_mod: training<br />.color_mod: training<br />Date: 2017-10-31<br />.value:  0.919664965",".color_mod: training<br />.color_mod: training<br />Date: 2017-12-31<br />.value:  2.901116757",".color_mod: training<br />.color_mod: training<br />Date: 2018-01-31<br />.value:  0.644228539",".color_mod: training<br />.color_mod: training<br />Date: 2018-02-28<br />.value:  0.288637212",".color_mod: training<br />.color_mod: training<br />Date: 2018-03-31<br />.value:  0.804440080",".color_mod: training<br />.color_mod: training<br />Date: 2018-04-30<br />.value:  0.068164605",".color_mod: training<br />.color_mod: training<br />Date: 2018-05-31<br />.value:  0.702369487",".color_mod: training<br />.color_mod: training<br />Date: 2018-06-30<br />.value:  1.023945658",".color_mod: training<br />.color_mod: training<br />Date: 2018-07-31<br />.value: -0.031377041",".color_mod: training<br />.color_mod: training<br />Date: 2018-08-31<br />.value:  0.286574957",".color_mod: training<br />.color_mod: training<br />Date: 2018-09-30<br />.value: -0.183514248",".color_mod: training<br />.color_mod: training<br />Date: 2018-10-31<br />.value:  0.152906049",".color_mod: training<br />.color_mod: training<br />Date: 2018-11-30<br />.value:  0.002037679",".color_mod: training<br />.color_mod: training<br />Date: 2018-12-31<br />.value:  1.126719028",".color_mod: training<br />.color_mod: training<br />Date: 2019-02-28<br />.value: -0.474629150",".color_mod: training<br />.color_mod: training<br />Date: 2019-03-31<br />.value: -0.142462456",".color_mod: training<br />.color_mod: training<br />Date: 2019-04-30<br />.value: -0.302931632",".color_mod: training<br />.color_mod: training<br />Date: 2019-05-31<br />.value: -0.290431758",".color_mod: training<br />.color_mod: training<br />Date: 2019-06-30<br />.value: -0.189600122",".color_mod: training<br />.color_mod: training<br />Date: 2019-07-31<br />.value: -0.416473938",".color_mod: training<br />.color_mod: training<br />Date: 2019-08-31<br />.value: -0.586711244",".color_mod: training<br />.color_mod: training<br />Date: 2019-09-30<br />.value: -0.655925512",".color_mod: training<br />.color_mod: training<br />Date: 2019-10-31<br />.value: -0.406744126",".color_mod: training<br />.color_mod: training<br />Date: 2019-11-30<br />.value: -0.245307082",".color_mod: training<br />.color_mod: training<br />Date: 2020-02-29<br />.value: -0.573728301",".color_mod: training<br />.color_mod: training<br />Date: 2020-03-31<br />.value: -0.521505049",".color_mod: training<br />.color_mod: training<br />Date: 2020-06-30<br />.value: -0.841425637",".color_mod: training<br />.color_mod: training<br />Date: 2020-07-31<br />.value: -0.838315744",".color_mod: training<br />.color_mod: training<br />Date: 2020-09-30<br />.value: -0.906493974"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"training","legendgroup":"training","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2017-01-31","2017-02-28","2017-03-31","2017-04-30","2017-06-30","2017-07-31","2017-08-31","2017-10-31","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-04-30","2018-05-31","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2019-01-31","2019-02-28","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-09-30","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-07-31","2020-08-31","2020-09-30"],"y":[0.964781079964261,1.17177550390611,3.15654678260268,1.18063420596512,1.60201955760727,1.09991018077179,1.0794263653469,0.919664965337671,1.05782243538114,2.90111675727054,0.644228539092953,0.288637211565227,0.0681646049208326,0.702369487078316,-0.0313770414915346,0.286574957048802,-0.183514247546497,0.152906048585631,0.00203767875140619,-0.428816076661721,-0.474629150404296,-0.302931631667477,-0.290431757838402,-0.18960012214244,-0.416473937648038,-0.655925512040311,-0.245307082295081,-0.0303128876231043,-0.618455048875206,-0.573728300851174,-0.521505048708756,-0.782026959963158,-0.996069834623397,-0.838315743722012,-0.963354982256761,-0.906493973538938],"text":[".color_mod: training<br />.color_mod: training<br />Date: 2017-01-31<br />.value:  0.964781080",".color_mod: training<br />.color_mod: training<br />Date: 2017-02-28<br />.value:  1.171775504",".color_mod: training<br />.color_mod: training<br />Date: 2017-03-31<br />.value:  3.156546783",".color_mod: training<br />.color_mod: training<br />Date: 2017-04-30<br />.value:  1.180634206",".color_mod: training<br />.color_mod: training<br />Date: 2017-06-30<br />.value:  1.602019558",".color_mod: training<br />.color_mod: training<br />Date: 2017-07-31<br />.value:  1.099910181",".color_mod: training<br />.color_mod: training<br />Date: 2017-08-31<br />.value:  1.079426365",".color_mod: training<br />.color_mod: training<br />Date: 2017-10-31<br />.value:  0.919664965",".color_mod: training<br />.color_mod: training<br />Date: 2017-11-30<br />.value:  1.057822435",".color_mod: training<br />.color_mod: training<br />Date: 2017-12-31<br />.value:  2.901116757",".color_mod: training<br />.color_mod: training<br />Date: 2018-01-31<br />.value:  0.644228539",".color_mod: training<br />.color_mod: training<br />Date: 2018-02-28<br />.value:  0.288637212",".color_mod: training<br />.color_mod: training<br />Date: 2018-04-30<br />.value:  0.068164605",".color_mod: training<br />.color_mod: training<br />Date: 2018-05-31<br />.value:  0.702369487",".color_mod: training<br />.color_mod: training<br />Date: 2018-07-31<br />.value: -0.031377041",".color_mod: training<br />.color_mod: training<br />Date: 2018-08-31<br />.value:  0.286574957",".color_mod: training<br />.color_mod: training<br />Date: 2018-09-30<br />.value: -0.183514248",".color_mod: training<br />.color_mod: training<br />Date: 2018-10-31<br />.value:  0.152906049",".color_mod: training<br />.color_mod: training<br />Date: 2018-11-30<br />.value:  0.002037679",".color_mod: training<br />.color_mod: training<br />Date: 2019-01-31<br />.value: -0.428816077",".color_mod: training<br />.color_mod: training<br />Date: 2019-02-28<br />.value: -0.474629150",".color_mod: training<br />.color_mod: training<br />Date: 2019-04-30<br />.value: -0.302931632",".color_mod: training<br />.color_mod: training<br />Date: 2019-05-31<br />.value: -0.290431758",".color_mod: training<br />.color_mod: training<br />Date: 2019-06-30<br />.value: -0.189600122",".color_mod: training<br />.color_mod: training<br />Date: 2019-07-31<br />.value: -0.416473938",".color_mod: training<br />.color_mod: training<br />Date: 2019-09-30<br />.value: -0.655925512",".color_mod: training<br />.color_mod: training<br />Date: 2019-11-30<br />.value: -0.245307082",".color_mod: training<br />.color_mod: training<br />Date: 2019-12-31<br />.value: -0.030312888",".color_mod: training<br />.color_mod: training<br />Date: 2020-01-31<br />.value: -0.618455049",".color_mod: training<br />.color_mod: training<br />Date: 2020-02-29<br />.value: -0.573728301",".color_mod: training<br />.color_mod: training<br />Date: 2020-03-31<br />.value: -0.521505049",".color_mod: training<br />.color_mod: training<br />Date: 2020-04-30<br />.value: -0.782026960",".color_mod: training<br />.color_mod: training<br />Date: 2020-05-31<br />.value: -0.996069835",".color_mod: training<br />.color_mod: training<br />Date: 2020-07-31<br />.value: -0.838315744",".color_mod: training<br />.color_mod: training<br />Date: 2020-08-31<br />.value: -0.963354982",".color_mod: training<br />.color_mod: training<br />Date: 2020-09-30<br />.value: -0.906493974"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"training","legendgroup":"training","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":["2017-01-31","2017-02-28","2017-03-31","2017-05-31","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2018-01-31","2018-02-28","2018-03-31","2018-06-30","2018-07-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-07-31","2019-08-31","2019-10-31","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31","2020-09-30"],"y":[0.964781079964261,1.17177550390611,3.15654678260268,1.6611536322656,1.09991018077179,1.0794263653469,1.06038370167493,0.919664965337671,1.05782243538114,0.644228539092953,0.288637211565227,0.804440079984477,1.02394565754625,-0.0313770414915346,-0.183514247546497,0.152906048585631,0.00203767875140619,1.12671902796385,-0.428816076661721,-0.474629150404296,-0.142462456311306,-0.302931631667477,-0.290431757838402,-0.416473937648038,-0.586711243923733,-0.406744125732374,-0.0303128876231043,-0.618455048875206,-0.573728300851174,-0.521505048708756,-0.782026959963158,-0.996069834623397,-0.841425637481853,-0.838315743722012,-0.963354982256761,-0.906493973538938],"text":[".color_mod: training<br />.color_mod: training<br />Date: 2017-01-31<br />.value:  0.964781080",".color_mod: training<br />.color_mod: training<br />Date: 2017-02-28<br />.value:  1.171775504",".color_mod: training<br />.color_mod: training<br />Date: 2017-03-31<br />.value:  3.156546783",".color_mod: training<br />.color_mod: training<br />Date: 2017-05-31<br />.value:  1.661153632",".color_mod: training<br />.color_mod: training<br />Date: 2017-07-31<br />.value:  1.099910181",".color_mod: training<br />.color_mod: training<br />Date: 2017-08-31<br />.value:  1.079426365",".color_mod: training<br />.color_mod: training<br />Date: 2017-09-30<br />.value:  1.060383702",".color_mod: training<br />.color_mod: training<br />Date: 2017-10-31<br />.value:  0.919664965",".color_mod: training<br />.color_mod: training<br />Date: 2017-11-30<br />.value:  1.057822435",".color_mod: training<br />.color_mod: training<br />Date: 2018-01-31<br />.value:  0.644228539",".color_mod: training<br />.color_mod: training<br />Date: 2018-02-28<br />.value:  0.288637212",".color_mod: training<br />.color_mod: training<br />Date: 2018-03-31<br />.value:  0.804440080",".color_mod: training<br />.color_mod: training<br />Date: 2018-06-30<br />.value:  1.023945658",".color_mod: training<br />.color_mod: training<br />Date: 2018-07-31<br />.value: -0.031377041",".color_mod: training<br />.color_mod: training<br />Date: 2018-09-30<br />.value: -0.183514248",".color_mod: training<br />.color_mod: training<br />Date: 2018-10-31<br />.value:  0.152906049",".color_mod: training<br />.color_mod: training<br />Date: 2018-11-30<br />.value:  0.002037679",".color_mod: training<br />.color_mod: training<br />Date: 2018-12-31<br />.value:  1.126719028",".color_mod: training<br />.color_mod: training<br />Date: 2019-01-31<br />.value: -0.428816077",".color_mod: training<br />.color_mod: training<br />Date: 2019-02-28<br />.value: -0.474629150",".color_mod: training<br />.color_mod: training<br />Date: 2019-03-31<br />.value: -0.142462456",".color_mod: training<br />.color_mod: training<br />Date: 2019-04-30<br />.value: -0.302931632",".color_mod: training<br />.color_mod: training<br />Date: 2019-05-31<br />.value: -0.290431758",".color_mod: training<br />.color_mod: training<br />Date: 2019-07-31<br />.value: -0.416473938",".color_mod: training<br />.color_mod: training<br />Date: 2019-08-31<br />.value: -0.586711244",".color_mod: training<br />.color_mod: training<br />Date: 2019-10-31<br />.value: -0.406744126",".color_mod: training<br />.color_mod: training<br />Date: 2019-12-31<br />.value: -0.030312888",".color_mod: training<br />.color_mod: training<br />Date: 2020-01-31<br />.value: -0.618455049",".color_mod: training<br />.color_mod: training<br />Date: 2020-02-29<br />.value: -0.573728301",".color_mod: training<br />.color_mod: training<br />Date: 2020-03-31<br />.value: -0.521505049",".color_mod: training<br />.color_mod: training<br />Date: 2020-04-30<br />.value: -0.782026960",".color_mod: training<br />.color_mod: training<br />Date: 2020-05-31<br />.value: -0.996069835",".color_mod: training<br />.color_mod: training<br />Date: 2020-06-30<br />.value: -0.841425637",".color_mod: training<br />.color_mod: training<br />Date: 2020-07-31<br />.value: -0.838315744",".color_mod: training<br />.color_mod: training<br />Date: 2020-08-31<br />.value: -0.963354982",".color_mod: training<br />.color_mod: training<br />Date: 2020-09-30<br />.value: -0.906493974"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"training","legendgroup":"training","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":["2017-01-31","2017-02-28","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2017-12-31","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-11-30","2018-12-31","2019-01-31","2019-03-31","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31"],"y":[0.964781079964261,1.17177550390611,1.18063420596512,1.6611536322656,1.60201955760727,1.09991018077179,1.0794263653469,1.06038370167493,0.919664965337671,1.05782243538114,2.90111675727054,0.804440079984477,0.0681646049208326,0.702369487078316,1.02394565754625,-0.0313770414915346,0.286574957048802,0.00203767875140619,1.12671902796385,-0.428816076661721,-0.142462456311306,-0.290431757838402,-0.18960012214244,-0.416473937648038,-0.586711243923733,-0.655925512040311,-0.406744125732374,-0.245307082295081,-0.0303128876231043,-0.618455048875206,-0.521505048708756,-0.782026959963158,-0.996069834623397,-0.841425637481853,-0.838315743722012,-0.963354982256761],"text":[".color_mod: training<br />.color_mod: training<br />Date: 2017-01-31<br />.value:  0.964781080",".color_mod: training<br />.color_mod: training<br />Date: 2017-02-28<br />.value:  1.171775504",".color_mod: training<br />.color_mod: training<br />Date: 2017-04-30<br />.value:  1.180634206",".color_mod: training<br />.color_mod: training<br />Date: 2017-05-31<br />.value:  1.661153632",".color_mod: training<br />.color_mod: training<br />Date: 2017-06-30<br />.value:  1.602019558",".color_mod: training<br />.color_mod: training<br />Date: 2017-07-31<br />.value:  1.099910181",".color_mod: training<br />.color_mod: training<br />Date: 2017-08-31<br />.value:  1.079426365",".color_mod: training<br />.color_mod: training<br />Date: 2017-09-30<br />.value:  1.060383702",".color_mod: training<br />.color_mod: training<br />Date: 2017-10-31<br />.value:  0.919664965",".color_mod: training<br />.color_mod: training<br />Date: 2017-11-30<br />.value:  1.057822435",".color_mod: training<br />.color_mod: training<br />Date: 2017-12-31<br />.value:  2.901116757",".color_mod: training<br />.color_mod: training<br />Date: 2018-03-31<br />.value:  0.804440080",".color_mod: training<br />.color_mod: training<br />Date: 2018-04-30<br />.value:  0.068164605",".color_mod: training<br />.color_mod: training<br />Date: 2018-05-31<br />.value:  0.702369487",".color_mod: training<br />.color_mod: training<br />Date: 2018-06-30<br />.value:  1.023945658",".color_mod: training<br />.color_mod: training<br />Date: 2018-07-31<br />.value: -0.031377041",".color_mod: training<br />.color_mod: training<br />Date: 2018-08-31<br />.value:  0.286574957",".color_mod: training<br />.color_mod: training<br />Date: 2018-11-30<br />.value:  0.002037679",".color_mod: training<br />.color_mod: training<br />Date: 2018-12-31<br />.value:  1.126719028",".color_mod: training<br />.color_mod: training<br />Date: 2019-01-31<br />.value: -0.428816077",".color_mod: training<br />.color_mod: training<br />Date: 2019-03-31<br />.value: -0.142462456",".color_mod: training<br />.color_mod: training<br />Date: 2019-05-31<br />.value: -0.290431758",".color_mod: training<br />.color_mod: training<br />Date: 2019-06-30<br />.value: -0.189600122",".color_mod: training<br />.color_mod: training<br />Date: 2019-07-31<br />.value: -0.416473938",".color_mod: training<br />.color_mod: training<br />Date: 2019-08-31<br />.value: -0.586711244",".color_mod: training<br />.color_mod: training<br />Date: 2019-09-30<br />.value: -0.655925512",".color_mod: training<br />.color_mod: training<br />Date: 2019-10-31<br />.value: -0.406744126",".color_mod: training<br />.color_mod: training<br />Date: 2019-11-30<br />.value: -0.245307082",".color_mod: training<br />.color_mod: training<br />Date: 2019-12-31<br />.value: -0.030312888",".color_mod: training<br />.color_mod: training<br />Date: 2020-01-31<br />.value: -0.618455049",".color_mod: training<br />.color_mod: training<br />Date: 2020-03-31<br />.value: -0.521505049",".color_mod: training<br />.color_mod: training<br />Date: 2020-04-30<br />.value: -0.782026960",".color_mod: training<br />.color_mod: training<br />Date: 2020-05-31<br />.value: -0.996069835",".color_mod: training<br />.color_mod: training<br />Date: 2020-06-30<br />.value: -0.841425637",".color_mod: training<br />.color_mod: training<br />Date: 2020-07-31<br />.value: -0.838315744",".color_mod: training<br />.color_mod: training<br />Date: 2020-08-31<br />.value: -0.963354982"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"training","legendgroup":"training","showlegend":false,"xaxis":"x2","yaxis":"y4","hoverinfo":"text","frame":null},{"x":["2017-01-31","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-08-31","2017-09-30","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-08-31","2018-09-30","2018-10-31","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-06-30","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-04-30","2020-05-31","2020-06-30","2020-08-31","2020-09-30"],"y":[0.964781079964261,3.15654678260268,1.18063420596512,1.6611536322656,1.60201955760727,1.0794263653469,1.06038370167493,1.05782243538114,2.90111675727054,0.644228539092953,0.288637211565227,0.804440079984477,0.0681646049208326,0.702369487078316,1.02394565754625,0.286574957048802,-0.183514247546497,0.152906048585631,1.12671902796385,-0.428816076661721,-0.474629150404296,-0.142462456311306,-0.302931631667477,-0.18960012214244,-0.586711243923733,-0.655925512040311,-0.406744125732374,-0.245307082295081,-0.0303128876231043,-0.618455048875206,-0.573728300851174,-0.782026959963158,-0.996069834623397,-0.841425637481853,-0.963354982256761,-0.906493973538938],"text":[".color_mod: training<br />.color_mod: training<br />Date: 2017-01-31<br />.value:  0.964781080",".color_mod: training<br />.color_mod: training<br />Date: 2017-03-31<br />.value:  3.156546783",".color_mod: training<br />.color_mod: training<br />Date: 2017-04-30<br />.value:  1.180634206",".color_mod: training<br />.color_mod: training<br />Date: 2017-05-31<br />.value:  1.661153632",".color_mod: training<br />.color_mod: training<br />Date: 2017-06-30<br />.value:  1.602019558",".color_mod: training<br />.color_mod: training<br />Date: 2017-08-31<br />.value:  1.079426365",".color_mod: training<br />.color_mod: training<br />Date: 2017-09-30<br />.value:  1.060383702",".color_mod: training<br />.color_mod: training<br />Date: 2017-11-30<br />.value:  1.057822435",".color_mod: training<br />.color_mod: training<br />Date: 2017-12-31<br />.value:  2.901116757",".color_mod: training<br />.color_mod: training<br />Date: 2018-01-31<br />.value:  0.644228539",".color_mod: training<br />.color_mod: training<br />Date: 2018-02-28<br />.value:  0.288637212",".color_mod: training<br />.color_mod: training<br />Date: 2018-03-31<br />.value:  0.804440080",".color_mod: training<br />.color_mod: training<br />Date: 2018-04-30<br />.value:  0.068164605",".color_mod: training<br />.color_mod: training<br />Date: 2018-05-31<br />.value:  0.702369487",".color_mod: training<br />.color_mod: training<br />Date: 2018-06-30<br />.value:  1.023945658",".color_mod: training<br />.color_mod: training<br />Date: 2018-08-31<br />.value:  0.286574957",".color_mod: training<br />.color_mod: training<br />Date: 2018-09-30<br />.value: -0.183514248",".color_mod: training<br />.color_mod: training<br />Date: 2018-10-31<br />.value:  0.152906049",".color_mod: training<br />.color_mod: training<br />Date: 2018-12-31<br />.value:  1.126719028",".color_mod: training<br />.color_mod: training<br />Date: 2019-01-31<br />.value: -0.428816077",".color_mod: training<br />.color_mod: training<br />Date: 2019-02-28<br />.value: -0.474629150",".color_mod: training<br />.color_mod: training<br />Date: 2019-03-31<br />.value: -0.142462456",".color_mod: training<br />.color_mod: training<br />Date: 2019-04-30<br />.value: -0.302931632",".color_mod: training<br />.color_mod: training<br />Date: 2019-06-30<br />.value: -0.189600122",".color_mod: training<br />.color_mod: training<br />Date: 2019-08-31<br />.value: -0.586711244",".color_mod: training<br />.color_mod: training<br />Date: 2019-09-30<br />.value: -0.655925512",".color_mod: training<br />.color_mod: training<br />Date: 2019-10-31<br />.value: -0.406744126",".color_mod: training<br />.color_mod: training<br />Date: 2019-11-30<br />.value: -0.245307082",".color_mod: training<br />.color_mod: training<br />Date: 2019-12-31<br />.value: -0.030312888",".color_mod: training<br />.color_mod: training<br />Date: 2020-01-31<br />.value: -0.618455049",".color_mod: training<br />.color_mod: training<br />Date: 2020-02-29<br />.value: -0.573728301",".color_mod: training<br />.color_mod: training<br />Date: 2020-04-30<br />.value: -0.782026960",".color_mod: training<br />.color_mod: training<br />Date: 2020-05-31<br />.value: -0.996069835",".color_mod: training<br />.color_mod: training<br />Date: 2020-06-30<br />.value: -0.841425637",".color_mod: training<br />.color_mod: training<br />Date: 2020-08-31<br />.value: -0.963354982",".color_mod: training<br />.color_mod: training<br />Date: 2020-09-30<br />.value: -0.906493974"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"training","legendgroup":"training","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"x":["2017-01-31","2017-08-31","2017-11-30","2019-01-31","2019-12-31","2020-01-31","2020-04-30","2020-05-31","2020-08-31"],"y":[0.964781079964261,1.0794263653469,1.05782243538114,-0.428816076661721,-0.0303128876231043,-0.618455048875206,-0.782026959963158,-0.996069834623397,-0.963354982256761],"text":[".color_mod: testing<br />.color_mod: testing<br />Date: 2017-01-31<br />.value:  0.964781080",".color_mod: testing<br />.color_mod: testing<br />Date: 2017-08-31<br />.value:  1.079426365",".color_mod: testing<br />.color_mod: testing<br />Date: 2017-11-30<br />.value:  1.057822435",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-01-31<br />.value: -0.428816077",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-12-31<br />.value: -0.030312888",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-01-31<br />.value: -0.618455049",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-04-30<br />.value: -0.782026960",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-05-31<br />.value: -0.996069835",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-08-31<br />.value: -0.963354982"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"testing","legendgroup":"testing","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2017-05-31","2017-09-30","2018-03-31","2018-06-30","2018-12-31","2019-03-31","2019-08-31","2019-10-31","2020-06-30"],"y":[1.6611536322656,1.06038370167493,0.804440079984477,1.02394565754625,1.12671902796385,-0.142462456311306,-0.586711243923733,-0.406744125732374,-0.841425637481853],"text":[".color_mod: testing<br />.color_mod: testing<br />Date: 2017-05-31<br />.value:  1.661153632",".color_mod: testing<br />.color_mod: testing<br />Date: 2017-09-30<br />.value:  1.060383702",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-03-31<br />.value:  0.804440080",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-06-30<br />.value:  1.023945658",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-12-31<br />.value:  1.126719028",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-03-31<br />.value: -0.142462456",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-08-31<br />.value: -0.586711244",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-10-31<br />.value: -0.406744126",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-06-30<br />.value: -0.841425637"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"testing","legendgroup":"testing","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":["2017-04-30","2017-06-30","2017-12-31","2018-04-30","2018-05-31","2018-08-31","2019-06-30","2019-09-30","2019-11-30"],"y":[1.18063420596512,1.60201955760727,2.90111675727054,0.0681646049208326,0.702369487078316,0.286574957048802,-0.18960012214244,-0.655925512040311,-0.245307082295081],"text":[".color_mod: testing<br />.color_mod: testing<br />Date: 2017-04-30<br />.value:  1.180634206",".color_mod: testing<br />.color_mod: testing<br />Date: 2017-06-30<br />.value:  1.602019558",".color_mod: testing<br />.color_mod: testing<br />Date: 2017-12-31<br />.value:  2.901116757",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-04-30<br />.value:  0.068164605",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-05-31<br />.value:  0.702369487",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-08-31<br />.value:  0.286574957",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-06-30<br />.value: -0.189600122",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-09-30<br />.value: -0.655925512",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-11-30<br />.value: -0.245307082"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"testing","legendgroup":"testing","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":["2017-03-31","2018-01-31","2018-02-28","2018-09-30","2018-10-31","2019-02-28","2019-04-30","2020-02-29","2020-09-30"],"y":[3.15654678260268,0.644228539092953,0.288637211565227,-0.183514247546497,0.152906048585631,-0.474629150404296,-0.302931631667477,-0.573728300851174,-0.906493973538938],"text":[".color_mod: testing<br />.color_mod: testing<br />Date: 2017-03-31<br />.value:  3.156546783",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-01-31<br />.value:  0.644228539",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-02-28<br />.value:  0.288637212",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-09-30<br />.value: -0.183514248",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-10-31<br />.value:  0.152906049",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-02-28<br />.value: -0.474629150",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-04-30<br />.value: -0.302931632",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-02-29<br />.value: -0.573728301",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-09-30<br />.value: -0.906493974"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"testing","legendgroup":"testing","showlegend":false,"xaxis":"x2","yaxis":"y4","hoverinfo":"text","frame":null},{"x":["2017-02-28","2017-07-31","2017-10-31","2018-07-31","2018-11-30","2019-05-31","2019-07-31","2020-03-31","2020-07-31"],"y":[1.17177550390611,1.09991018077179,0.919664965337671,-0.0313770414915346,0.00203767875140619,-0.290431757838402,-0.416473937648038,-0.521505048708756,-0.838315743722012],"text":[".color_mod: testing<br />.color_mod: testing<br />Date: 2017-02-28<br />.value:  1.171775504",".color_mod: testing<br />.color_mod: testing<br />Date: 2017-07-31<br />.value:  1.099910181",".color_mod: testing<br />.color_mod: testing<br />Date: 2017-10-31<br />.value:  0.919664965",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-07-31<br />.value: -0.031377041",".color_mod: testing<br />.color_mod: testing<br />Date: 2018-11-30<br />.value:  0.002037679",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-05-31<br />.value: -0.290431758",".color_mod: testing<br />.color_mod: testing<br />Date: 2019-07-31<br />.value: -0.416473938",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-03-31<br />.value: -0.521505049",".color_mod: testing<br />.color_mod: testing<br />Date: 2020-07-31<br />.value: -0.838315744"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"testing","legendgroup":"testing","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":55.4520547945205,"r":7.30593607305936,"b":25.5707762557078,"l":22.648401826484},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Time Series Cross Validation Plan","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,0.455069925879439],"automargin":true,"type":"date","autorange":true,"range":["2016-11-25","2020-12-05"],"tickmode":"auto","ticktext":["2017","2018","2019","2020"],"tickvals":[17167,17532,17897,18262],"categoryorder":"array","categoryarray":["2017","2018","2019","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y5","title":"","hoverformat":".2f"},"yaxis":{"domain":[0.729222845431992,1],"automargin":true,"type":"linear","autorange":true,"range":[-1.2037006654847,3.36417761346398],"tickmode":"auto","ticktext":["-1","0","1","2","3"],"tickvals":[-1,0,1,2,3],"categoryorder":"array","categoryarray":["-1","0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.455069925879439,"y0":0.729222845431992,"y1":1},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.455069925879439,"y0":0,"y1":24.9730178497302,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.544930074120561,"x1":1,"y0":0.729222845431992,"y1":1},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.544930074120561,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.455069925879439,"y0":0.395889512098659,"y1":0.604110487901341},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.455069925879439,"y0":0,"y1":24.9730178497302,"yanchor":0.604110487901341,"ysizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.544930074120561,"x1":1,"y0":0.395889512098659,"y1":0.604110487901341},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.544930074120561,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":0.604110487901341,"ysizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.455069925879439,"y0":0,"y1":0.270777154568008},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.455069925879439,"y0":0,"y1":24.9730178497302,"yanchor":0.270777154568008,"ysizemode":"pixel"}],"annotations":[{"text":"Fold1","x":0.22753496293972,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Fold2","x":0.77246503706028,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Fold3","x":0.22753496293972,"y":0.604110487901341,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Fold4","x":0.77246503706028,"y":0.604110487901341,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Fold5","x":0.22753496293972,"y":0.270777154568008,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Legend","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"xaxis2":{"type":"date","autorange":true,"range":["2016-11-25","2020-12-05"],"tickmode":"auto","ticktext":["2017","2018","2019","2020"],"tickvals":[17167,17532,17897,18262],"categoryorder":"array","categoryarray":["2017","2018","2019","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.544930074120561,1],"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":true,"range":[-1.2037006654847,3.36417761346398],"tickmode":"auto","ticktext":["-1","0","1","2","3"],"tickvals":[-1,0,1,2,3],"categoryorder":"array","categoryarray":["-1","0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.729222845431992,1],"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":true,"range":[-1.2037006654847,3.36417761346398],"tickmode":"auto","ticktext":["-1","0","1","2","3"],"tickvals":[-1,0,1,2,3],"categoryorder":"array","categoryarray":["-1","0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.395889512098659,0.604110487901341],"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":true,"range":[-1.2037006654847,3.36417761346398],"tickmode":"auto","ticktext":["-1","0","1","2","3"],"tickvals":[-1,0,1,2,3],"categoryorder":"array","categoryarray":["-1","0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.395889512098659,0.604110487901341],"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":true,"range":[-1.2037006654847,3.36417761346398],"tickmode":"auto","ticktext":["-1","0","1","2","3"],"tickvals":[-1,0,1,2,3],"categoryorder":"array","categoryarray":["-1","0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.270777154568008],"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"y":0.93503937007874},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"490244dbbb4":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"490244dbbb4","visdat":{"490244dbbb4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

```r
cell_folds <- vfold_cv(train_cleaned)

# MODEL
model_spec_nnet_tune <- mlp(
  mode = "regression",
  hidden_units = 5,
  penalty = 0.3,
  epochs = tune(), #epochs parameter will be tunned as a hyperparameter
  dropout = 0,
  activation = 'linear'
  
) %>%
  set_engine("nnet", trace = 0)


# MODEL SPEC
wflw_spec_nnet_tune <- workflow() %>%
  add_model(model_spec_nnet_tune) %>%
  add_recipe(recipe_spec %>% update_role(Date, new_role = "indicator"))


# TUNNING STAGE

tic()
set.seed(123)
tune_results_nnet <- wflw_spec_nnet_tune %>%
  tune_grid(
    resamples = resamples_kfold,
    param_info = parameters(wflw_spec_nnet_tune) %>%
      update(
        epochs = epochs(c(10, 1000))),
    grid = 10,
    control = control_grid(verbose = TRUE, allow_par = TRUE)
  )
toc()
```

```
## 28.952 sec elapsed
```

```r
# DISPLAY RESULTS (Best option)

tune_results_nnet %>% show_best("rmse", n = Inf)
```

```
## # A tibble: 10 × 7
##    epochs .metric .estimator  mean     n std_err .config              
##     <int> <chr>   <chr>      <dbl> <int>   <dbl> <fct>                
##  1    210 rmse    standard   0.432     5  0.0593 Preprocessor1_Model04
##  2    360 rmse    standard   0.432     5  0.0592 Preprocessor1_Model09
##  3    467 rmse    standard   0.432     5  0.0593 Preprocessor1_Model06
##  4    183 rmse    standard   0.432     5  0.0593 Preprocessor1_Model10
##  5    691 rmse    standard   0.432     5  0.0600 Preprocessor1_Model05
##  6     91 rmse    standard   0.433     5  0.0599 Preprocessor1_Model08
##  7    845 rmse    standard   0.433     5  0.0598 Preprocessor1_Model01
##  8    916 rmse    standard   0.433     5  0.0598 Preprocessor1_Model07
##  9    720 rmse    standard   0.433     5  0.0598 Preprocessor1_Model03
## 10    515 rmse    standard   0.433     5  0.0598 Preprocessor1_Model02
```

```r
# ** Finalize

wflw_fit_nnet_tuned <- wflw_spec_nnet_tune %>%
  finalize_workflow(select_best(tune_results_nnet, "rmse")) %>%
  fit(train_cleaned)
```


### 9. Model integration (Sequential Models + Non-Sequential)

The goal of integrating all models into one single table is to have a better approach to assess the accuracy of all of them. We can also combine several models into one **(ENSEMBLE)** by average them together with the goal to have a better prediction.



```r
submodels_2_tbl <- modeltime_table(
  wflw_fit_nnet_tuned) %>%
  update_model_description(1, "NEURAL NETWORK 24-5-1") %>%  
  combine_modeltime_tables(submodels_1_tbl) %>%
  update_model_description(2, "ARIMA (1,1,1)(2,1,0)[12] + XREGS") %>%
  update_model_description(3, "ARIMA(0,0,1) + STL") %>%
  update_model_description(4, "XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS") 

#Calibration ----
calibration_tbl <- submodels_2_tbl %>%
  modeltime_calibrate(testing(splits))

#Accuracy ----
calibration_tbl %>% 
  modeltime_accuracy() %>%
  arrange(rmse)
```

```
## # A tibble: 4 × 9
##   .model_id .model_desc               .type    mae  mape  mase smape  rmse   rsq
##       <int> <chr>                     <chr>  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
## 1         1 NEURAL NETWORK 24-5-1     Test  0.0837  9.88 0.439  9.87 0.104 0.867
## 2         4 XGBOOST ARIMA(1,1,2)(2,1… Test  0.114  12.0  0.599 12.5  0.143 0.541
## 3         2 ARIMA (1,1,1)(2,1,0)[12]… Test  0.188  19.4  0.989 19.8  0.223 0.461
## 4         3 ARIMA(0,0,1) + STL        Test  0.186  25.9  0.973 29.6  0.283 0.827
```


From this table, we can extract the value of **rmse**, which is one metric that assess better the accuracy of our prediction. Root Mean Square Error (RMSE) is the standard deviation of the residuals (prediction errors). Residuals are a measure of how far from the regression line data points are; RMSE is a measure of how spread out these residuals are. The shorter the value, the better. In other words, it tells you how concentrated the data is, around the line of best fit. According to the results, the **NEURAL NETWORK** and the **XGBOOST ARIMA + XREGS** are the best models.

### 10. Model representation (Plotting results)


Let's take a look at the forecasted models:



```r
calibration_tbl %>%
  modeltime_forecast(
    new_data    = testing(splits),
    actual_data = data_prepared_tbl,
    keep_data   = TRUE  
  ) %>%
  

  plot_modeltime_forecast(
    .facet_ncol         = 4, 
    .conf_interval_show = FALSE,
    .interactive        = TRUE, 
    .title = "Forecasting Models Assessment (transformed)"
  )
```

```{=html}
<div id="htmlwidget-cd7631ab4534d86081f2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cd7631ab4534d86081f2">{"x":{"data":[{"x":["2017-01-31","2017-02-28","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31","2020-09-30","2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[0.964781079964261,1.17177550390611,3.15654678260268,1.18063420596512,1.6611536322656,1.60201955760727,1.09991018077179,1.0794263653469,1.06038370167493,0.919664965337671,1.05782243538114,2.90111675727054,0.644228539092953,0.288637211565227,0.804440079984477,0.0681646049208326,0.702369487078316,1.02394565754625,-0.0313770414915346,0.286574957048802,-0.183514247546497,0.152906048585631,0.00203767875140619,1.12671902796385,-0.428816076661721,-0.474629150404296,-0.142462456311306,-0.302931631667477,-0.290431757838402,-0.18960012214244,-0.416473937648038,-0.586711243923733,-0.655925512040311,-0.406744125732374,-0.245307082295081,-0.0303128876231043,-0.618455048875206,-0.573728300851174,-0.521505048708756,-0.782026959963158,-0.996069834623397,-0.841425637481853,-0.838315743722012,-0.963354982256761,-0.906493973538938,-0.77616409770199,-0.868951486757543,-0.509710334937613,-1.15967566061982,-1.12323800644115,-0.866651483741603,-1.01454290554311,-1.0394863811165,-0.913568414387942,-1.08495265476928,-1.1629214956172,-1.00878273565046],"text":[".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-01-31<br />.value:  0.964781080",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-02-28<br />.value:  1.171775504",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-03-31<br />.value:  3.156546783",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-04-30<br />.value:  1.180634206",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-05-31<br />.value:  1.661153632",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-06-30<br />.value:  1.602019558",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-07-31<br />.value:  1.099910181",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-08-31<br />.value:  1.079426365",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-09-30<br />.value:  1.060383702",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-10-31<br />.value:  0.919664965",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-11-30<br />.value:  1.057822435",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-12-31<br />.value:  2.901116757",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-01-31<br />.value:  0.644228539",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-02-28<br />.value:  0.288637212",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-03-31<br />.value:  0.804440080",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-04-30<br />.value:  0.068164605",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-05-31<br />.value:  0.702369487",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-06-30<br />.value:  1.023945658",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-07-31<br />.value: -0.031377041",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-08-31<br />.value:  0.286574957",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-09-30<br />.value: -0.183514248",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-10-31<br />.value:  0.152906049",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-11-30<br />.value:  0.002037679",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-12-31<br />.value:  1.126719028",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-01-31<br />.value: -0.428816077",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-02-28<br />.value: -0.474629150",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-03-31<br />.value: -0.142462456",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-04-30<br />.value: -0.302931632",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-05-31<br />.value: -0.290431758",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-06-30<br />.value: -0.189600122",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-07-31<br />.value: -0.416473938",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-08-31<br />.value: -0.586711244",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-09-30<br />.value: -0.655925512",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-10-31<br />.value: -0.406744126",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-11-30<br />.value: -0.245307082",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-12-31<br />.value: -0.030312888",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-01-31<br />.value: -0.618455049",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-02-29<br />.value: -0.573728301",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-03-31<br />.value: -0.521505049",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-04-30<br />.value: -0.782026960",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-05-31<br />.value: -0.996069835",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-06-30<br />.value: -0.841425637",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-07-31<br />.value: -0.838315744",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-08-31<br />.value: -0.963354982",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-09-30<br />.value: -0.906493974",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-10-31<br />.value: -0.776164098",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-11-30<br />.value: -0.868951487",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-12-31<br />.value: -0.509710335",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-01-31<br />.value: -1.159675661",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-02-28<br />.value: -1.123238006",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-03-31<br />.value: -0.866651484",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-04-30<br />.value: -1.014542906",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-05-31<br />.value: -1.039486381",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-06-30<br />.value: -0.913568414",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-07-31<br />.value: -1.084952655",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-08-31<br />.value: -1.162921496",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-09-30<br />.value: -1.008782736"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[-0.893245768379754,-0.871221990050809,-0.356854534439181,-1.13205403552996,-1.14649509745217,-0.913571303206702,-1.16444945917126,-1.09770216892263,-1.05115260780687,-1.17854417963319,-1.17007163075746,-1.19689544509533],"text":[".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2020-10-31<br />.value: -0.893245768",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2020-11-30<br />.value: -0.871221990",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2020-12-31<br />.value: -0.356854534",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-01-31<br />.value: -1.132054036",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-02-28<br />.value: -1.146495097",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-03-31<br />.value: -0.913571303",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-04-30<br />.value: -1.164449459",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-05-31<br />.value: -1.097702169",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-06-30<br />.value: -1.051152608",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-07-31<br />.value: -1.178544180",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-08-31<br />.value: -1.170071631",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-09-30<br />.value: -1.196895445"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"1_NEURAL NETWORK 24-5-1","legendgroup":"1_NEURAL NETWORK 24-5-1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[-0.744950549754989,-0.504462122840991,-0.424510481025521,-0.869761737564247,-0.874635429836914,-0.860106793712063,-1.12819563308429,-1.38040015630735,-1.22329508169696,-1.18315706638194,-1.31035912450011,-1.23483867115239],"text":[".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2020-10-31<br />.value: -0.744950550",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2020-11-30<br />.value: -0.504462123",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2020-12-31<br />.value: -0.424510481",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-01-31<br />.value: -0.869761738",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-02-28<br />.value: -0.874635430",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-03-31<br />.value: -0.860106794",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-04-30<br />.value: -1.128195633",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-05-31<br />.value: -1.380400156",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-06-30<br />.value: -1.223295082",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-07-31<br />.value: -1.183157066",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-08-31<br />.value: -1.310359125",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-09-30<br />.value: -1.234838671"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(24,188,156,1)","dash":"solid"},"hoveron":"points","name":"2_ARIMA (1,1,1)(2,1,0)[12] + XREGS","legendgroup":"2_ARIMA (1,1,1)(2,1,0)[12] + XREGS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[-0.85539327174067,-0.76283741929622,0.323517408318826,-1.1974393897291,-1.20415694665085,-0.515198434156406,-1.19265386977403,-0.949612074675896,-0.775329518831622,-1.16997328744127,-1.14159407076114,-1.23434110789964],"text":[".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2020-10-31<br />.value: -0.855393272",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2020-11-30<br />.value: -0.762837419",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2020-12-31<br />.value:  0.323517408",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-01-31<br />.value: -1.197439390",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-02-28<br />.value: -1.204156947",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-03-31<br />.value: -0.515198434",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-04-30<br />.value: -1.192653870",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-05-31<br />.value: -0.949612075",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-06-30<br />.value: -0.775329519",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-07-31<br />.value: -1.169973287",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-08-31<br />.value: -1.141594071",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-09-30<br />.value: -1.234341108"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(204,190,147,1)","dash":"solid"},"hoveron":"points","name":"3_ARIMA(0,0,1) + STL","legendgroup":"3_ARIMA(0,0,1) + STL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[-0.69212168020033,-0.844072584722418,-0.663899190194523,-0.949730873901028,-0.877587407495146,-0.878637045788073,-0.992742127328795,-1.11709048755448,-0.921328413066582,-0.848200784218496,-0.984834928211365,-0.891664784016854],"text":[".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2020-10-31<br />.value: -0.692121680",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2020-11-30<br />.value: -0.844072585",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2020-12-31<br />.value: -0.663899190",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-01-31<br />.value: -0.949730874",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-02-28<br />.value: -0.877587407",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-03-31<br />.value: -0.878637046",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-04-30<br />.value: -0.992742127",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-05-31<br />.value: -1.117090488",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-06-30<br />.value: -0.921328413",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-07-31<br />.value: -0.848200784",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-08-31<br />.value: -0.984834928",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-09-30<br />.value: -0.891664784"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(166,206,227,1)","dash":"solid"},"hoveron":"points","name":"4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...","legendgroup":"4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":22.648401826484},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Forecasting Models Assessment (transformed)","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["2016-11-06","2021-12-24"],"tickmode":"auto","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[-1.60724750325285,3.38339412954818],"tickmode":"auto","ticktext":["-1","0","1","2","3"],"tickvals":[-1,0,1,2,3],"categoryorder":"array","categoryarray":["-1","0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"Legend","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"49041b1b34c":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"49041b1b34c","visdat":{"49041b1b34c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```


In order to visualize the data in the original values, we need to apply the inverse of the standardization and the logarithm:



```r
# EXECUTING THE INVERSE OF THE LOGARITHM AND THE STANDARDIZATION:

forecast_test_tbl <- submodels_2_tbl %>%
  modeltime_forecast(
    new_data    = testing(splits),
    actual_data = data_prepared_tbl,
    keep_data   = TRUE) %>%
  mutate(
    value_trans= value_trans %>% standardize_inv_vec(mean = 2.88065437189917 , sd = 0.577155837177902))%>%
  mutate(
    .value = .value %>% standardize_inv_vec(mean = 2.88065437189917 , sd = 0.577155837177902)) %>% 
  mutate(
    value_trans= value_trans %>% log_interval_inv_vec(limit_lower = 0, limit_upper = 1325114.92929216, offset = 1e+06)  ) %>%
  mutate(
    .value = .value %>% log_interval_inv_vec(limit_lower = 0, limit_upper = 1325114.92929216, offset = 1e+06))


### PREDICTION

table_forecast_metrics <- forecast_test_tbl %>% 
  select(Date, .value, .model_desc, value_trans)

forecast_test_tbl %>%
  plot_modeltime_forecast(
    .facet_ncol = 4, .title = "Forecasting Models Assessment"
  )
```

```{=html}
<div id="htmlwidget-88e5c99c5c5e49cecba9" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-88e5c99c5c5e49cecba9">{"x":{"data":[{"x":["2017-01-31","2017-02-28","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31","2020-09-30","2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[283845.1109096,288363.5169264,313200.5167376,288545.769536,297216.3138096,296268.7962,286852.0472688,286410.296508,285995.191188,282791.1455904,285939.0306016,311327.6751464,275770.2112904,265038.6583528,279979.928504,257303.6350232,277339.8600792,285188.8252296,253510.4030584,264970.357896,247324.5236632,260382.3009152,254805.532608,287422.817092,236286.5009408,234069.963664,249041.4029272,242121.575316,242681.0526896,247066.9263704,236875.0218288,228429.6309576,224787.465264,237336.4222496,244671.593276001,253551.9934912,226774.592092,229099.105296,231749.0690216,217826.5753656,204997.928516001,214397.3558328,214579.3417784,207044.4609328,210526.7354168,218159.749664,212774.6818424,232338.1399328,194277.4611912,196736.480668,212911.0911712,203828.2543416,202232.6398264,210098.601904,199275.6633448,194056.391192,204194.0703472],"text":[".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-01-31<br />.value: 283845.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-02-28<br />.value: 288363.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-03-31<br />.value: 313200.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-04-30<br />.value: 288545.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-05-31<br />.value: 297216.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-06-30<br />.value: 296268.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-07-31<br />.value: 286852.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-08-31<br />.value: 286410.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-09-30<br />.value: 285995.2",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-10-31<br />.value: 282791.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-11-30<br />.value: 285939.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-12-31<br />.value: 311327.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-01-31<br />.value: 275770.2",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-02-28<br />.value: 265038.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-03-31<br />.value: 279979.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-04-30<br />.value: 257303.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-05-31<br />.value: 277339.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-06-30<br />.value: 285188.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-07-31<br />.value: 253510.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-08-31<br />.value: 264970.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-09-30<br />.value: 247324.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-10-31<br />.value: 260382.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-11-30<br />.value: 254805.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-12-31<br />.value: 287422.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-01-31<br />.value: 236286.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-02-28<br />.value: 234070.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-03-31<br />.value: 249041.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-04-30<br />.value: 242121.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-05-31<br />.value: 242681.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-06-30<br />.value: 247066.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-07-31<br />.value: 236875.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-08-31<br />.value: 228429.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-09-30<br />.value: 224787.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-10-31<br />.value: 237336.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-11-30<br />.value: 244671.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-12-31<br />.value: 253552.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-01-31<br />.value: 226774.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-02-29<br />.value: 229099.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-03-31<br />.value: 231749.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-04-30<br />.value: 217826.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-05-31<br />.value: 204997.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-06-30<br />.value: 214397.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-07-31<br />.value: 214579.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-08-31<br />.value: 207044.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-09-30<br />.value: 210526.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-10-31<br />.value: 218159.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-11-30<br />.value: 212774.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-12-31<br />.value: 232338.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-01-31<br />.value: 194277.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-02-28<br />.value: 196736.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-03-31<br />.value: 212911.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-04-30<br />.value: 203828.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-05-31<br />.value: 202232.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-06-30<br />.value: 210098.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-07-31<br />.value: 199275.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-08-31<br />.value: 194056.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-09-30<br />.value: 204194.1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[211324.615633196,212639.874517486,239667.223543765,196145.335701249,195171.765090803,210098.426782127,193952.208322859,198435.114934621,201479.910758693,192987.690959199,193568.230524311,191722.444900258],"text":[".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2020-10-31<br />.value: 211324.6",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2020-11-30<br />.value: 212639.9",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2020-12-31<br />.value: 239667.2",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-01-31<br />.value: 196145.3",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-02-28<br />.value: 195171.8",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-03-31<br />.value: 210098.4",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-04-30<br />.value: 193952.2",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-05-31<br />.value: 198435.1",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-06-30<br />.value: 201479.9",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-07-31<br />.value: 192987.7",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-08-31<br />.value: 193568.2",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-09-30<br />.value: 191722.4"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"1_NEURAL NETWORK 24-5-1","legendgroup":"1_NEURAL NETWORK 24-5-1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[219917.709654909,232599.148369228,236492.221005967,212726.591391954,212436.931071403,213298.423726154,196404.353083608,178468.737039364,189883.426476723,192670.658680865,183658.419015665,189072.252381331],"text":[".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2020-10-31<br />.value: 219917.7",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2020-11-30<br />.value: 232599.1",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2020-12-31<br />.value: 236492.2",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-01-31<br />.value: 212726.6",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-02-28<br />.value: 212436.9",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-03-31<br />.value: 213298.4",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-04-30<br />.value: 196404.4",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-05-31<br />.value: 178468.7",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-06-30<br />.value: 189883.4",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-07-31<br />.value: 192670.7",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-08-31<br />.value: 183658.4",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-09-30<br />.value: 189072.3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(24,188,156,1)","dash":"solid"},"hoveron":"points","name":"2_ARIMA (1,1,1)(2,1,0)[12] + XREGS","legendgroup":"2_ARIMA (1,1,1)(2,1,0)[12] + XREGS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[213576.630436098,218913.568635584,266182.731257304,191684.778408813,191218.829181548,232064.473036623,192015.837149648,207894.751422457,218207.100242216,193574.955670363,195502.908867853,189107.30509964],"text":[".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2020-10-31<br />.value: 213576.6",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2020-11-30<br />.value: 218913.6",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2020-12-31<br />.value: 266182.7",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-01-31<br />.value: 191684.8",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-02-28<br />.value: 191218.8",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-03-31<br />.value: 232064.5",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-04-30<br />.value: 192015.8",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-05-31<br />.value: 207894.8",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-06-30<br />.value: 218207.1",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-07-31<br />.value: 193575.0",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-08-31<br />.value: 195502.9",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-09-30<br />.value: 189107.3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(204,190,147,1)","dash":"solid"},"hoveron":"points","name":"3_ARIMA(0,0,1) + STL","legendgroup":"3_ARIMA(0,0,1) + STL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[222832.975490788,214242.246293988,224359.87591602,207887.424916986,212261.155733563,212198.595173368,205207.549135264,197147.260288196,209627.315207723,213999.942103015,205704.322540452,211419.494359588],"text":[".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2020-10-31<br />.value: 222833.0",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2020-11-30<br />.value: 214242.2",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2020-12-31<br />.value: 224359.9",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-01-31<br />.value: 207887.4",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-02-28<br />.value: 212261.2",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-03-31<br />.value: 212198.6",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-04-30<br />.value: 205207.5",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-05-31<br />.value: 197147.3",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-06-30<br />.value: 209627.3",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-07-31<br />.value: 213999.9",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-08-31<br />.value: 205704.3",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-09-30<br />.value: 211419.5"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(166,206,227,1)","dash":"solid"},"hoveron":"points","name":"4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...","legendgroup":"4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":46.027397260274},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Forecasting Models Assessment","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["2016-11-06","2021-12-24"],"tickmode":"auto","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[171732.148054452,319937.105722512],"tickmode":"auto","ticktext":["200000","240000","280000"],"tickvals":[200000,240000,280000],"categoryorder":"array","categoryarray":["200000","240000","280000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"Legend","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4902e0d52ce":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"4902e0d52ce","visdat":{"4902e0d52ce":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```


Lets take a closer look to the most recent data:



```r
table_forecast_metrics <- forecast_test_tbl %>% 
  select(Date, .value, .model_desc, value_trans)

forecast_test_tbl %>%
  filter_by_time(.date_var = Date, .start_date = '2021-01-01', .end_date = '2021-09-30') %>%
  plot_modeltime_forecast(
    .facet_ncol = 4, .title = "Forecasting Models Assessment (Year 2021 only)"
  )
```

```{=html}
<div id="htmlwidget-f09c78490b07c003bbfa" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f09c78490b07c003bbfa">{"x":{"data":[{"x":["2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[194277.4611912,196736.480668,212911.0911712,203828.2543416,202232.6398264,210098.601904,199275.6633448,194056.391192,204194.0703472],"text":[".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-01-31<br />.value: 194277.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-02-28<br />.value: 196736.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-03-31<br />.value: 212911.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-04-30<br />.value: 203828.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-05-31<br />.value: 202232.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-06-30<br />.value: 210098.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-07-31<br />.value: 199275.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-08-31<br />.value: 194056.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-09-30<br />.value: 204194.1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[196145.335701249,195171.765090803,210098.426782127,193952.208322859,198435.114934621,201479.910758693,192987.690959199,193568.230524311,191722.444900258],"text":[".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-01-31<br />.value: 196145.3",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-02-28<br />.value: 195171.8",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-03-31<br />.value: 210098.4",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-04-30<br />.value: 193952.2",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-05-31<br />.value: 198435.1",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-06-30<br />.value: 201479.9",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-07-31<br />.value: 192987.7",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-08-31<br />.value: 193568.2",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-09-30<br />.value: 191722.4"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"1_NEURAL NETWORK 24-5-1","legendgroup":"1_NEURAL NETWORK 24-5-1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[212726.591391954,212436.931071403,213298.423726154,196404.353083608,178468.737039364,189883.426476723,192670.658680865,183658.419015665,189072.252381331],"text":[".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-01-31<br />.value: 212726.6",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-02-28<br />.value: 212436.9",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-03-31<br />.value: 213298.4",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-04-30<br />.value: 196404.4",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-05-31<br />.value: 178468.7",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-06-30<br />.value: 189883.4",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-07-31<br />.value: 192670.7",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-08-31<br />.value: 183658.4",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-09-30<br />.value: 189072.3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(24,188,156,1)","dash":"solid"},"hoveron":"points","name":"2_ARIMA (1,1,1)(2,1,0)[12] + XREGS","legendgroup":"2_ARIMA (1,1,1)(2,1,0)[12] + XREGS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[191684.778408813,191218.829181548,232064.473036623,192015.837149648,207894.751422457,218207.100242216,193574.955670363,195502.908867853,189107.30509964],"text":[".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-01-31<br />.value: 191684.8",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-02-28<br />.value: 191218.8",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-03-31<br />.value: 232064.5",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-04-30<br />.value: 192015.8",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-05-31<br />.value: 207894.8",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-06-30<br />.value: 218207.1",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-07-31<br />.value: 193575.0",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-08-31<br />.value: 195502.9",".color_mod: 3_ARIMA(0,0,1) + STL<br />.color_mod: 3_ARIMA(0,0,1) + STL<br />.index: 2021-09-30<br />.value: 189107.3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(204,190,147,1)","dash":"solid"},"hoveron":"points","name":"3_ARIMA(0,0,1) + STL","legendgroup":"3_ARIMA(0,0,1) + STL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[207887.424916986,212261.155733563,212198.595173368,205207.549135264,197147.260288196,209627.315207723,213999.942103015,205704.322540452,211419.494359588],"text":[".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-01-31<br />.value: 207887.4",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-02-28<br />.value: 212261.2",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-03-31<br />.value: 212198.6",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-04-30<br />.value: 205207.5",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-05-31<br />.value: 197147.3",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-06-30<br />.value: 209627.3",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-07-31<br />.value: 213999.9",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-08-31<br />.value: 205704.3",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-09-30<br />.value: 211419.5"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(166,206,227,1)","dash":"solid"},"hoveron":"points","name":"4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...","legendgroup":"4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":46.027397260274},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Forecasting Models Assessment (Year 2021 only)","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["2021-01-18","2021-10-12"],"tickmode":"auto","ticktext":["Apr","Jul","Oct"],"tickvals":[18718,18809,18901],"categoryorder":"array","categoryarray":["Apr","Jul","Oct"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[175788.950239501,234744.259836486],"tickmode":"auto","ticktext":["180000","190000","200000","210000","220000","230000"],"tickvals":[180000,190000,200000,210000,220000,230000],"categoryorder":"array","categoryarray":["180000","190000","200000","210000","220000","230000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"Legend","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"490fc061a8":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"490fc061a8","visdat":{"490fc061a8":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```



### 11. Proposed Forecasting Models vs Traditional Model (Best Estimate)

Next step is to compare the results against the traditional forecasting method **(BEST ESTIMATE)** that our department of Finance was providing to us. First, lets integrate the data.



```r
library(viridis)

fin_data_forecast <- fin_data %>% filter(Category %in% c('Forecast') & Metric == 'Revenue') %>%
  arrange(Date, ascending = TRUE) %>% group_by(Category, Metric, Date) %>% summarize(.value = sum(Value)) %>% filter_by_time(.date_var = Date, .start_date = "2021-08-01", .end_date = "2021-09-30") %>% ungroup() %>% 
  mutate(.model_desc = "Forecast (BE)")  

fin_data_forecast$Category <- NULL
fin_data_forecast$Metric <- NULL
fin_data_forecast$value_trans <- c(194056.4, 204194.1)

table_forecast_metrics <- rbind(table_forecast_metrics, fin_data_forecast)

table_forecast_metrics_ggplot <- table_forecast_metrics %>%
  ggplot( aes(x=Date, y=.value, group=.model_desc, color=.model_desc)) +
  geom_line() +
  scale_color_viridis(discrete = TRUE) +
  ggtitle("Proposed Forecasting Model Vs Best Estimate (Original prediction)") +
  theme_ipsum() +
  ylab("Actuals ($revenue)")

ggplotly(table_forecast_metrics_ggplot)
```

```{=html}
<div id="htmlwidget-d53498d68625ac08a831" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d53498d68625ac08a831">{"x":{"data":[{"x":[17197,17225,17256,17286,17317,17347,17378,17409,17439,17470,17500,17531,17562,17590,17621,17651,17682,17712,17743,17774,17804,17835,17865,17896,17927,17955,17986,18016,18047,18077,18108,18139,18169,18200,18230,18261,18292,18321,18352,18382,18413,18443,18474,18505,18535,18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[283845.1109096,288363.5169264,313200.5167376,288545.769536,297216.3138096,296268.7962,286852.0472688,286410.296508,285995.191188,282791.1455904,285939.0306016,311327.6751464,275770.2112904,265038.6583528,279979.928504,257303.6350232,277339.8600792,285188.8252296,253510.4030584,264970.357896,247324.5236632,260382.3009152,254805.532608,287422.817092,236286.5009408,234069.963664,249041.4029272,242121.575316,242681.0526896,247066.9263704,236875.0218288,228429.6309576,224787.465264,237336.4222496,244671.593276001,253551.9934912,226774.592092,229099.105296,231749.0690216,217826.5753656,204997.928516001,214397.3558328,214579.3417784,207044.4609328,210526.7354168,218159.749664,212774.6818424,232338.1399328,194277.4611912,196736.480668,212911.0911712,203828.2543416,202232.6398264,210098.601904,199275.6633448,194056.391192,204194.0703472],"text":["Date: 2017-01-31<br />.value: 283845.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-02-28<br />.value: 288363.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-03-31<br />.value: 313200.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-04-30<br />.value: 288545.8<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-05-31<br />.value: 297216.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-06-30<br />.value: 296268.8<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-07-31<br />.value: 286852.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-08-31<br />.value: 286410.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-09-30<br />.value: 285995.2<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-10-31<br />.value: 282791.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-11-30<br />.value: 285939.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-12-31<br />.value: 311327.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-01-31<br />.value: 275770.2<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-02-28<br />.value: 265038.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-03-31<br />.value: 279979.9<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-04-30<br />.value: 257303.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-05-31<br />.value: 277339.9<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-06-30<br />.value: 285188.8<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-07-31<br />.value: 253510.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-08-31<br />.value: 264970.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-09-30<br />.value: 247324.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-10-31<br />.value: 260382.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-11-30<br />.value: 254805.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-12-31<br />.value: 287422.8<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-01-31<br />.value: 236286.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-02-28<br />.value: 234070.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-03-31<br />.value: 249041.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-04-30<br />.value: 242121.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-05-31<br />.value: 242681.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-06-30<br />.value: 247066.9<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-07-31<br />.value: 236875.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-08-31<br />.value: 228429.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-09-30<br />.value: 224787.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-10-31<br />.value: 237336.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-11-30<br />.value: 244671.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-12-31<br />.value: 253552.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-01-31<br />.value: 226774.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-02-29<br />.value: 229099.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-03-31<br />.value: 231749.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-04-30<br />.value: 217826.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-05-31<br />.value: 204997.9<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-06-30<br />.value: 214397.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-07-31<br />.value: 214579.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-08-31<br />.value: 207044.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-09-30<br />.value: 210526.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-10-31<br />.value: 218159.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-11-30<br />.value: 212774.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-12-31<br />.value: 232338.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-01-31<br />.value: 194277.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-02-28<br />.value: 196736.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-03-31<br />.value: 212911.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-04-30<br />.value: 203828.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-05-31<br />.value: 202232.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-06-30<br />.value: 210098.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-07-31<br />.value: 199275.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-08-31<br />.value: 194056.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-09-30<br />.value: 204194.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[219917.709654909,232599.148369228,236492.221005967,212726.591391954,212436.931071403,213298.423726154,196404.353083608,178468.737039364,189883.426476723,192670.658680865,183658.419015665,189072.252381331],"text":["Date: 2020-10-31<br />.value: 219917.7<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2020-11-30<br />.value: 232599.1<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2020-12-31<br />.value: 236492.2<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-01-31<br />.value: 212726.6<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-02-28<br />.value: 212436.9<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-03-31<br />.value: 213298.4<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-04-30<br />.value: 196404.4<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-05-31<br />.value: 178468.7<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-06-30<br />.value: 189883.4<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-07-31<br />.value: 192670.7<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-08-31<br />.value: 183658.4<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-09-30<br />.value: 189072.3<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(65,68,135,1)","dash":"solid"},"hoveron":"points","name":"ARIMA (1,1,1)(2,1,0)[12] + XREGS","legendgroup":"ARIMA (1,1,1)(2,1,0)[12] + XREGS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[213576.630436098,218913.568635584,266182.731257304,191684.778408813,191218.829181548,232064.473036623,192015.837149648,207894.751422457,218207.100242216,193574.955670363,195502.908867853,189107.30509964],"text":["Date: 2020-10-31<br />.value: 213576.6<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2020-11-30<br />.value: 218913.6<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2020-12-31<br />.value: 266182.7<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-01-31<br />.value: 191684.8<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-02-28<br />.value: 191218.8<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-03-31<br />.value: 232064.5<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-04-30<br />.value: 192015.8<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-05-31<br />.value: 207894.8<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-06-30<br />.value: 218207.1<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-07-31<br />.value: 193575.0<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-08-31<br />.value: 195502.9<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-09-30<br />.value: 189107.3<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(42,120,142,1)","dash":"solid"},"hoveron":"points","name":"ARIMA(0,0,1) + STL","legendgroup":"ARIMA(0,0,1) + STL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18870,18900],"y":[208041.646948809,210630.068549162],"text":["Date: 2021-08-31<br />.value: 208041.6<br />.model_desc: Forecast (BE)<br />.model_desc: Forecast (BE)","Date: 2021-09-30<br />.value: 210630.1<br />.model_desc: Forecast (BE)<br />.model_desc: Forecast (BE)"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(34,168,132,1)","dash":"solid"},"hoveron":"points","name":"Forecast (BE)","legendgroup":"Forecast (BE)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[211324.615633196,212639.874517486,239667.223543765,196145.335701249,195171.765090803,210098.426782127,193952.208322859,198435.114934621,201479.910758693,192987.690959199,193568.230524311,191722.444900258],"text":["Date: 2020-10-31<br />.value: 211324.6<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2020-11-30<br />.value: 212639.9<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2020-12-31<br />.value: 239667.2<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-01-31<br />.value: 196145.3<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-02-28<br />.value: 195171.8<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-03-31<br />.value: 210098.4<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-04-30<br />.value: 193952.2<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-05-31<br />.value: 198435.1<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-06-30<br />.value: 201479.9<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-07-31<br />.value: 192987.7<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-08-31<br />.value: 193568.2<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-09-30<br />.value: 191722.4<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(122,209,81,1)","dash":"solid"},"hoveron":"points","name":"NEURAL NETWORK 24-5-1","legendgroup":"NEURAL NETWORK 24-5-1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[222832.975490788,214242.246293988,224359.87591602,207887.424916986,212261.155733563,212198.595173368,205207.549135264,197147.260288196,209627.315207723,213999.942103015,205704.322540452,211419.494359588],"text":["Date: 2020-10-31<br />.value: 222833.0<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2020-11-30<br />.value: 214242.2<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2020-12-31<br />.value: 224359.9<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-01-31<br />.value: 207887.4<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-02-28<br />.value: 212261.2<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-03-31<br />.value: 212198.6<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-04-30<br />.value: 205207.5<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-05-31<br />.value: 197147.3<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-06-30<br />.value: 209627.3<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-07-31<br />.value: 213999.9<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-08-31<br />.value: 205704.3<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-09-30<br />.value: 211419.5<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","legendgroup":"XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":95.7011207970112,"r":39.8505603985056,"b":86.8410128684101,"l":101.452885014529},"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605},"title":{"text":"<b> Proposed Forecasting Model Vs Best Estimate (Original prediction) <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":23.9103362391034},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[17111.85,18985.15],"tickmode":"array","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"y","title":{"text":"Date","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[171732.148054452,319937.105722512],"tickmode":"array","ticktext":["200000","240000","280000"],"tickvals":[200000,240000,280000],"categoryorder":"array","categoryarray":["200000","240000","280000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"x","title":{"text":"Actuals ($revenue)","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":12.2208385222084},"y":0.932086614173228},"annotations":[{"text":".model_desc","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"49042017251":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"49042017251","visdat":{"49042017251":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```



```r
table_forecast_metrics_ggplot <- table_forecast_metrics %>% 
  filter_by_time(.date_var = Date, .start_date = '2021-01-01', .end_date = '2021-09-30') %>%
  ggplot( aes(x=Date, y=.value, group=.model_desc, color=.model_desc)) +
  geom_line() +
  scale_color_viridis(discrete = TRUE) +
  ggtitle("Proposed Forecasting Model Vs Best Estimate - Year 2021") +
  theme_ipsum() +
  ylab("Actuals ($revenue)")

ggplotly(table_forecast_metrics_ggplot)
```

```{=html}
<div id="htmlwidget-1cdc86719cdb55675ac7" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1cdc86719cdb55675ac7">{"x":{"data":[{"x":[18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[194277.4611912,196736.480668,212911.0911712,203828.2543416,202232.6398264,210098.601904,199275.6633448,194056.391192,204194.0703472],"text":["Date: 2021-01-31<br />.value: 194277.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-02-28<br />.value: 196736.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-03-31<br />.value: 212911.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-04-30<br />.value: 203828.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-05-31<br />.value: 202232.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-06-30<br />.value: 210098.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-07-31<br />.value: 199275.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-08-31<br />.value: 194056.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-09-30<br />.value: 204194.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[212726.591391954,212436.931071403,213298.423726154,196404.353083608,178468.737039364,189883.426476723,192670.658680865,183658.419015665,189072.252381331],"text":["Date: 2021-01-31<br />.value: 212726.6<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-02-28<br />.value: 212436.9<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-03-31<br />.value: 213298.4<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-04-30<br />.value: 196404.4<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-05-31<br />.value: 178468.7<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-06-30<br />.value: 189883.4<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-07-31<br />.value: 192670.7<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-08-31<br />.value: 183658.4<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS","Date: 2021-09-30<br />.value: 189072.3<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.model_desc: ARIMA (1,1,1)(2,1,0)[12] + XREGS"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(65,68,135,1)","dash":"solid"},"hoveron":"points","name":"ARIMA (1,1,1)(2,1,0)[12] + XREGS","legendgroup":"ARIMA (1,1,1)(2,1,0)[12] + XREGS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[191684.778408813,191218.829181548,232064.473036623,192015.837149648,207894.751422457,218207.100242216,193574.955670363,195502.908867853,189107.30509964],"text":["Date: 2021-01-31<br />.value: 191684.8<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-02-28<br />.value: 191218.8<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-03-31<br />.value: 232064.5<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-04-30<br />.value: 192015.8<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-05-31<br />.value: 207894.8<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-06-30<br />.value: 218207.1<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-07-31<br />.value: 193575.0<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-08-31<br />.value: 195502.9<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL","Date: 2021-09-30<br />.value: 189107.3<br />.model_desc: ARIMA(0,0,1) + STL<br />.model_desc: ARIMA(0,0,1) + STL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(42,120,142,1)","dash":"solid"},"hoveron":"points","name":"ARIMA(0,0,1) + STL","legendgroup":"ARIMA(0,0,1) + STL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18870,18900],"y":[208041.646948809,210630.068549162],"text":["Date: 2021-08-31<br />.value: 208041.6<br />.model_desc: Forecast (BE)<br />.model_desc: Forecast (BE)","Date: 2021-09-30<br />.value: 210630.1<br />.model_desc: Forecast (BE)<br />.model_desc: Forecast (BE)"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(34,168,132,1)","dash":"solid"},"hoveron":"points","name":"Forecast (BE)","legendgroup":"Forecast (BE)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[196145.335701249,195171.765090803,210098.426782127,193952.208322859,198435.114934621,201479.910758693,192987.690959199,193568.230524311,191722.444900258],"text":["Date: 2021-01-31<br />.value: 196145.3<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-02-28<br />.value: 195171.8<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-03-31<br />.value: 210098.4<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-04-30<br />.value: 193952.2<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-05-31<br />.value: 198435.1<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-06-30<br />.value: 201479.9<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-07-31<br />.value: 192987.7<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-08-31<br />.value: 193568.2<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1","Date: 2021-09-30<br />.value: 191722.4<br />.model_desc: NEURAL NETWORK 24-5-1<br />.model_desc: NEURAL NETWORK 24-5-1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(122,209,81,1)","dash":"solid"},"hoveron":"points","name":"NEURAL NETWORK 24-5-1","legendgroup":"NEURAL NETWORK 24-5-1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[207887.424916986,212261.155733563,212198.595173368,205207.549135264,197147.260288196,209627.315207723,213999.942103015,205704.322540452,211419.494359588],"text":["Date: 2021-01-31<br />.value: 207887.4<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-02-28<br />.value: 212261.2<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-03-31<br />.value: 212198.6<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-04-30<br />.value: 205207.5<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-05-31<br />.value: 197147.3<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-06-30<br />.value: 209627.3<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-07-31<br />.value: 213999.9<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-08-31<br />.value: 205704.3<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","Date: 2021-09-30<br />.value: 211419.5<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS<br />.model_desc: XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","legendgroup":"XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":95.7011207970112,"r":39.8505603985056,"b":86.8410128684101,"l":101.452885014529},"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605},"title":{"text":"<b> Proposed Forecasting Model Vs Best Estimate - Year 2021 <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":23.9103362391034},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[18645.9,18912.1],"tickmode":"array","ticktext":["Apr","Jul","Oct"],"tickvals":[18718,18809,18901],"categoryorder":"array","categoryarray":["Apr","Jul","Oct"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"y","title":{"text":"Date","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[175788.950239501,234744.259836486],"tickmode":"array","ticktext":["180000","190000","200000","210000","220000","230000"],"tickvals":[180000,190000,200000,210000,220000,230000],"categoryorder":"array","categoryarray":["180000","190000","200000","210000","220000","230000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"x","title":{"text":"Actuals ($revenue)","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":12.2208385222084},"y":0.932086614173228},"annotations":[{"text":".model_desc","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"49073833166":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"49073833166","visdat":{"49073833166":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```


Lets how our model generalizes for unseen data:




```r
model_refit_tbl <- submodels_2_tbl %>%
  modeltime_refit(data_prepared_tbl)

modeltime_forecast_tbl <- model_refit_tbl %>%
  modeltime_forecast(
    new_data    = future_tbl,
    actual_data = data_prepared_tbl,
    keep_data   = TRUE 
  ) %>%
  mutate(
    value_trans= value_trans %>% standardize_inv_vec(mean = 2.88065437189917 , sd =0.577155837177902))%>%
  mutate(
    .value = .value %>% standardize_inv_vec(mean = 2.88065437189917 , sd = 0.577155837177902)) %>%
  mutate(
    value_trans= value_trans %>% log_interval_inv_vec(limit_lower = 0, limit_upper = 1325114.92929216, offset = 1e+06)) %>%
  mutate(
    .value = .value %>% log_interval_inv_vec(limit_lower = 0, limit_upper = 1325114.92929216, offset = 1e+06))

modeltime_forecast_tbl %>% 
  plot_modeltime_forecast(
    
  )
```

```{=html}
<div id="htmlwidget-b20d372114f9bb8493a3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b20d372114f9bb8493a3">{"x":{"data":[{"x":["2017-01-31","2017-02-28","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31","2020-09-30","2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[283845.1109096,288363.5169264,313200.5167376,288545.769536,297216.3138096,296268.7962,286852.0472688,286410.296508,285995.191188,282791.1455904,285939.0306016,311327.6751464,275770.2112904,265038.6583528,279979.928504,257303.6350232,277339.8600792,285188.8252296,253510.4030584,264970.357896,247324.5236632,260382.3009152,254805.532608,287422.817092,236286.5009408,234069.963664,249041.4029272,242121.575316,242681.0526896,247066.9263704,236875.0218288,228429.6309576,224787.465264,237336.4222496,244671.593276001,253551.9934912,226774.592092,229099.105296,231749.0690216,217826.5753656,204997.928516001,214397.3558328,214579.3417784,207044.4609328,210526.7354168,218159.749664,212774.6818424,232338.1399328,194277.4611912,196736.480668,212911.0911712,203828.2543416,202232.6398264,210098.601904,199275.6633448,194056.391192,204194.0703472],"text":[".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-01-31<br />.value: 283845.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-02-28<br />.value: 288363.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-03-31<br />.value: 313200.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-04-30<br />.value: 288545.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-05-31<br />.value: 297216.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-06-30<br />.value: 296268.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-07-31<br />.value: 286852.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-08-31<br />.value: 286410.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-09-30<br />.value: 285995.2",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-10-31<br />.value: 282791.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-11-30<br />.value: 285939.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-12-31<br />.value: 311327.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-01-31<br />.value: 275770.2",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-02-28<br />.value: 265038.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-03-31<br />.value: 279979.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-04-30<br />.value: 257303.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-05-31<br />.value: 277339.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-06-30<br />.value: 285188.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-07-31<br />.value: 253510.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-08-31<br />.value: 264970.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-09-30<br />.value: 247324.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-10-31<br />.value: 260382.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-11-30<br />.value: 254805.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-12-31<br />.value: 287422.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-01-31<br />.value: 236286.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-02-28<br />.value: 234070.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-03-31<br />.value: 249041.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-04-30<br />.value: 242121.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-05-31<br />.value: 242681.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-06-30<br />.value: 247066.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-07-31<br />.value: 236875.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-08-31<br />.value: 228429.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-09-30<br />.value: 224787.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-10-31<br />.value: 237336.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-11-30<br />.value: 244671.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-12-31<br />.value: 253552.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-01-31<br />.value: 226774.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-02-29<br />.value: 229099.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-03-31<br />.value: 231749.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-04-30<br />.value: 217826.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-05-31<br />.value: 204997.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-06-30<br />.value: 214397.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-07-31<br />.value: 214579.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-08-31<br />.value: 207044.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-09-30<br />.value: 210526.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-10-31<br />.value: 218159.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-11-30<br />.value: 212774.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-12-31<br />.value: 232338.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-01-31<br />.value: 194277.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-02-28<br />.value: 196736.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-03-31<br />.value: 212911.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-04-30<br />.value: 203828.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-05-31<br />.value: 202232.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-06-30<br />.value: 210098.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-07-31<br />.value: 199275.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-08-31<br />.value: 194056.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-09-30<br />.value: 204194.1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-10-31","2021-11-30"],"y":[202517.889917505,204600.526683645],"text":[".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-10-31<br />.value: 202517.9",".color_mod: 1_NEURAL NETWORK 24-5-1<br />.color_mod: 1_NEURAL NETWORK 24-5-1<br />.index: 2021-11-30<br />.value: 204600.5"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"1_NEURAL NETWORK 24-5-1","legendgroup":"1_NEURAL NETWORK 24-5-1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-10-31","2021-11-30"],"y":[208884.558032269,203430.537535739],"text":[".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-10-31<br />.value: 208884.6",".color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.color_mod: 2_ARIMA (1,1,1)(2,1,0)[12] + XREGS<br />.index: 2021-11-30<br />.value: 203430.5"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(24,188,156,1)","dash":"solid"},"hoveron":"points","name":"2_ARIMA (1,1,1)(2,1,0)[12] + XREGS","legendgroup":"2_ARIMA (1,1,1)(2,1,0)[12] + XREGS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-10-31","2021-11-30"],"y":[192081.673865636,203775.632899176],"text":[".color_mod: 3_UPDATE: SEASONAL DECOMP: REGRESSION...<br />.color_mod: 3_UPDATE: SEASONAL DECOMP: REGRESSION...<br />.index: 2021-10-31<br />.value: 192081.7",".color_mod: 3_UPDATE: SEASONAL DECOMP: REGRESSION...<br />.color_mod: 3_UPDATE: SEASONAL DECOMP: REGRESSION...<br />.index: 2021-11-30<br />.value: 203775.6"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(204,190,147,1)","dash":"solid"},"hoveron":"points","name":"3_UPDATE: SEASONAL DECOMP: REGRESSION...","legendgroup":"3_UPDATE: SEASONAL DECOMP: REGRESSION...","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2021-10-31","2021-11-30"],"y":[218498.95701228,176900.464333524],"text":[".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-10-31<br />.value: 218499.0",".color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.color_mod: 4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...<br />.index: 2021-11-30<br />.value: 176900.5"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(166,206,227,1)","dash":"solid"},"hoveron":"points","name":"4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...","legendgroup":"4_XGBOOST ARIMA(1,1,2)(2,1,0)[12] + X...","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":46.027397260274},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Forecast Plot","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["2016-11-03","2022-02-26"],"tickmode":"auto","ticktext":["2018","2020","2022"],"tickvals":[17532,18262,18993],"categoryorder":"array","categoryarray":["2018","2020","2022"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[170085.46171332,320015.519357804],"tickmode":"auto","ticktext":["200000","240000","280000","320000"],"tickvals":[200000,240000,280000,320000],"categoryorder":"array","categoryarray":["200000","240000","280000","320000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"Legend","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4902ad006cc":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"4902ad006cc","visdat":{"4902ad006cc":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```



### 12. ASSESSMENT: Proposed Forecasting Models vs Traditional Model (Best Estimate)

Next step, is to assess the model(s) that provide a better prediction.



```r
table_forecast_metrics %>% filter_by_time(.date_var = Date, .start_date = '2021-08-31', .end_date = '2021-09-30') %>%
  select(.model_desc, .value, value_trans) %>%
  group_by(.model_desc) %>% 
  summarize_accuracy_metrics(
    truth      = value_trans, 
    estimate   = .value,
    metric_set = metric_set(mae, rmse)
  )
```

```
## # A tibble: 6 × 3
##   .model_desc                                mae   rmse
##   <chr>                                    <dbl>  <dbl>
## 1 ACTUAL                                      0      0 
## 2 ARIMA (1,1,1)(2,1,0)[12] + XREGS        12760. 12977.
## 3 ARIMA(0,0,1) + STL                       8267. 10717.
## 4 Forecast (BE)                           10211. 10886.
## 5 NEURAL NETWORK 24-5-1                    6480.  8826.
## 6 XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS  9437.  9692.
```

In terms of **root mean square errors and mean absolute errors**, we can see that our proposed models over-passed the traditional method. It seems that on average, both models **Neural Network & ARIMA(0,0,1) + STL** output a better prediction. 

One thing to note here is that **RMSE** is used when small errors can be safely ignored and big errors must be penalized and reduced as much as possible. On the other hand, the **MAE** is a better choice where the errors get worse linearly. So in our case, this metric should be a better choice when comparing the models on the future.



### 13. ASSESSMENT: Ensemble Model (Proposed) vs Traditional Model (Best Estimate)

In machine learning there is a concept called **Ensemble Models** that in short, it combines the output of several models into one single output (model). The decision of our summary metric is arbitrary, but most useful options are **mean and median**.

Next, we are going to create an ensemble model wich contains the best models proposed in terms of **MAE**: 

**1. NEURAL NETWORK 24-5-1**

**2. XGBOOST ARIMA(1,1,2)(2,1,0)[12] + XREGS**



```r
# SELECTING MODELS TO SUMMARIZE
submodels_2_ids_to_keep <- c(1,4)

# CREATING ENSEMBLE TABLE

ensemble_fit <- submodels_2_tbl %>%
  filter(.model_id %in% submodels_2_ids_to_keep) %>%
  ensemble_average(type = "median")

model_ensemble_tbl <- modeltime_table(
  ensemble_fit
)

forecast_ensemble_test_tbl <- model_ensemble_tbl %>%
  modeltime_forecast(
    new_data    = testing(splits),
    actual_data = data_prepared_tbl,
    keep_data   = TRUE
  ) %>% mutate(
    value_trans= value_trans %>% standardize_inv_vec(mean = 2.88065437189917 , sd =0.577155837177902))%>%
  mutate(
    .value = .value %>% standardize_inv_vec(mean = 2.88065437189917 , sd = 0.577155837177902)) %>%
  mutate(
    value_trans= value_trans %>% log_interval_inv_vec(limit_lower = 0, limit_upper = 1325114.92929216, offset = 1e+06)) %>%
  mutate(
    .value = .value %>% log_interval_inv_vec(limit_lower = 0, limit_upper = 1325114.92929216, offset = 1e+06))

forecast_ensemble_test_tbl %>%
  plot_modeltime_forecast(
    .facet_ncol = 4, .title = "ENSEMBLE MODEL (NNET + XGBOOST ARIMA) Vs Revenue (Actuals)"
  )
```

```{=html}
<div id="htmlwidget-ec40d3b954dbdf8737b1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ec40d3b954dbdf8737b1">{"x":{"data":[{"x":["2017-01-31","2017-02-28","2017-03-31","2017-04-30","2017-05-31","2017-06-30","2017-07-31","2017-08-31","2017-09-30","2017-10-31","2017-11-30","2017-12-31","2018-01-31","2018-02-28","2018-03-31","2018-04-30","2018-05-31","2018-06-30","2018-07-31","2018-08-31","2018-09-30","2018-10-31","2018-11-30","2018-12-31","2019-01-31","2019-02-28","2019-03-31","2019-04-30","2019-05-31","2019-06-30","2019-07-31","2019-08-31","2019-09-30","2019-10-31","2019-11-30","2019-12-31","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31","2020-06-30","2020-07-31","2020-08-31","2020-09-30","2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[283845.1109096,288363.5169264,313200.5167376,288545.769536,297216.3138096,296268.7962,286852.0472688,286410.296508,285995.191188,282791.1455904,285939.0306016,311327.6751464,275770.2112904,265038.6583528,279979.928504,257303.6350232,277339.8600792,285188.8252296,253510.4030584,264970.357896,247324.5236632,260382.3009152,254805.532608,287422.817092,236286.5009408,234069.963664,249041.4029272,242121.575316,242681.0526896,247066.9263704,236875.0218288,228429.6309576,224787.465264,237336.4222496,244671.593276001,253551.9934912,226774.592092,229099.105296,231749.0690216,217826.5753656,204997.928516001,214397.3558328,214579.3417784,207044.4609328,210526.7354168,218159.749664,212774.6818424,232338.1399328,194277.4611912,196736.480668,212911.0911712,203828.2543416,202232.6398264,210098.601904,199275.6633448,194056.391192,204194.0703472],"text":[".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-01-31<br />.value: 283845.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-02-28<br />.value: 288363.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-03-31<br />.value: 313200.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-04-30<br />.value: 288545.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-05-31<br />.value: 297216.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-06-30<br />.value: 296268.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-07-31<br />.value: 286852.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-08-31<br />.value: 286410.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-09-30<br />.value: 285995.2",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-10-31<br />.value: 282791.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-11-30<br />.value: 285939.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2017-12-31<br />.value: 311327.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-01-31<br />.value: 275770.2",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-02-28<br />.value: 265038.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-03-31<br />.value: 279979.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-04-30<br />.value: 257303.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-05-31<br />.value: 277339.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-06-30<br />.value: 285188.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-07-31<br />.value: 253510.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-08-31<br />.value: 264970.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-09-30<br />.value: 247324.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-10-31<br />.value: 260382.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-11-30<br />.value: 254805.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2018-12-31<br />.value: 287422.8",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-01-31<br />.value: 236286.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-02-28<br />.value: 234070.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-03-31<br />.value: 249041.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-04-30<br />.value: 242121.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-05-31<br />.value: 242681.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-06-30<br />.value: 247066.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-07-31<br />.value: 236875.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-08-31<br />.value: 228429.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-09-30<br />.value: 224787.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-10-31<br />.value: 237336.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-11-30<br />.value: 244671.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2019-12-31<br />.value: 253552.0",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-01-31<br />.value: 226774.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-02-29<br />.value: 229099.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-03-31<br />.value: 231749.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-04-30<br />.value: 217826.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-05-31<br />.value: 204997.9",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-06-30<br />.value: 214397.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-07-31<br />.value: 214579.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-08-31<br />.value: 207044.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-09-30<br />.value: 210526.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-10-31<br />.value: 218159.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-11-30<br />.value: 212774.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2020-12-31<br />.value: 232338.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-01-31<br />.value: 194277.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-02-28<br />.value: 196736.5",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-03-31<br />.value: 212911.1",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-04-30<br />.value: 203828.3",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-05-31<br />.value: 202232.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-06-30<br />.value: 210098.6",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-07-31<br />.value: 199275.7",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-08-31<br />.value: 194056.4",".color_mod: ACTUAL<br />.color_mod: ACTUAL<br />.index: 2021-09-30<br />.value: 204194.1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["2020-10-31","2020-11-30","2020-12-31","2021-01-31","2021-02-28","2021-03-31","2021-04-30","2021-05-31","2021-06-30","2021-07-31","2021-08-31","2021-09-30"],"y":[217218.549122441,213443.669939006,232304.942950567,202142.135582369,203987.251043641,211152.893596518,199692.890060755,197792.642836145,205616.151912237,203902.665901683,199767.746445066,201923.837477069],"text":[".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2020-10-31<br />.value: 217218.5",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2020-11-30<br />.value: 213443.7",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2020-12-31<br />.value: 232304.9",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2021-01-31<br />.value: 202142.1",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2021-02-28<br />.value: 203987.3",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2021-03-31<br />.value: 211152.9",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2021-04-30<br />.value: 199692.9",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2021-05-31<br />.value: 197792.6",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2021-06-30<br />.value: 205616.2",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2021-07-31<br />.value: 203902.7",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2021-08-31<br />.value: 199767.7",".color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.color_mod: 1_ENSEMBLE (MEDIAN): 2 MODELS<br />.index: 2021-09-30<br />.value: 201923.8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"1_ENSEMBLE (MEDIAN): 2 MODELS","legendgroup":"1_ENSEMBLE (MEDIAN): 2 MODELS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":46.027397260274},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"ENSEMBLE MODEL (NNET + XGBOOST ARIMA) Vs Revenue (Actuals)","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["2016-11-06","2021-12-24"],"tickmode":"auto","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[188099.18491472,319157.72301488],"tickmode":"auto","ticktext":["200000","240000","280000"],"tickvals":[200000,240000,280000],"categoryorder":"array","categoryarray":["200000","240000","280000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"Legend","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4905c6c4c59":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"4905c6c4c59","visdat":{"4905c6c4c59":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```



```r
table_forecast_ensemble_metrics <- forecast_ensemble_test_tbl %>% 
  select(Date, .value, .model_desc, .key, value_trans) 

fin_data_forecast$.key = 'ACTUAL'

table_forecast_ensemble_metrics <- rbind(table_forecast_ensemble_metrics, fin_data_forecast)
table(table_forecast_ensemble_metrics$.model_desc)
```

```
## 
##                      ACTUAL ENSEMBLE (MEDIAN): 2 MODELS 
##                          57                          12 
##               Forecast (BE) 
##                           2
```

```r
table_forecast_ensemble_metrics_ggplot <- table_forecast_ensemble_metrics %>%
  ggplot(aes(x=Date, y=.value, group=.model_desc, color=.model_desc)) +
  geom_line() +
  scale_color_viridis(discrete = TRUE) +
  ggtitle("Ensemble Model Vs Traditional Method (Best Estimate)") +
  theme_ipsum() +
  ylab("Revenue (Actuals)")

ggplotly(table_forecast_ensemble_metrics_ggplot)
```

```{=html}
<div id="htmlwidget-6895522fd142418cb0c5" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6895522fd142418cb0c5">{"x":{"data":[{"x":[17197,17225,17256,17286,17317,17347,17378,17409,17439,17470,17500,17531,17562,17590,17621,17651,17682,17712,17743,17774,17804,17835,17865,17896,17927,17955,17986,18016,18047,18077,18108,18139,18169,18200,18230,18261,18292,18321,18352,18382,18413,18443,18474,18505,18535,18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[283845.1109096,288363.5169264,313200.5167376,288545.769536,297216.3138096,296268.7962,286852.0472688,286410.296508,285995.191188,282791.1455904,285939.0306016,311327.6751464,275770.2112904,265038.6583528,279979.928504,257303.6350232,277339.8600792,285188.8252296,253510.4030584,264970.357896,247324.5236632,260382.3009152,254805.532608,287422.817092,236286.5009408,234069.963664,249041.4029272,242121.575316,242681.0526896,247066.9263704,236875.0218288,228429.6309576,224787.465264,237336.4222496,244671.593276001,253551.9934912,226774.592092,229099.105296,231749.0690216,217826.5753656,204997.928516001,214397.3558328,214579.3417784,207044.4609328,210526.7354168,218159.749664,212774.6818424,232338.1399328,194277.4611912,196736.480668,212911.0911712,203828.2543416,202232.6398264,210098.601904,199275.6633448,194056.391192,204194.0703472],"text":["Date: 2017-01-31<br />.value: 283845.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-02-28<br />.value: 288363.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-03-31<br />.value: 313200.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-04-30<br />.value: 288545.8<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-05-31<br />.value: 297216.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-06-30<br />.value: 296268.8<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-07-31<br />.value: 286852.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-08-31<br />.value: 286410.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-09-30<br />.value: 285995.2<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-10-31<br />.value: 282791.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-11-30<br />.value: 285939.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2017-12-31<br />.value: 311327.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-01-31<br />.value: 275770.2<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-02-28<br />.value: 265038.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-03-31<br />.value: 279979.9<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-04-30<br />.value: 257303.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-05-31<br />.value: 277339.9<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-06-30<br />.value: 285188.8<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-07-31<br />.value: 253510.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-08-31<br />.value: 264970.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-09-30<br />.value: 247324.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-10-31<br />.value: 260382.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-11-30<br />.value: 254805.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2018-12-31<br />.value: 287422.8<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-01-31<br />.value: 236286.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-02-28<br />.value: 234070.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-03-31<br />.value: 249041.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-04-30<br />.value: 242121.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-05-31<br />.value: 242681.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-06-30<br />.value: 247066.9<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-07-31<br />.value: 236875.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-08-31<br />.value: 228429.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-09-30<br />.value: 224787.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-10-31<br />.value: 237336.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-11-30<br />.value: 244671.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2019-12-31<br />.value: 253552.0<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-01-31<br />.value: 226774.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-02-29<br />.value: 229099.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-03-31<br />.value: 231749.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-04-30<br />.value: 217826.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-05-31<br />.value: 204997.9<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-06-30<br />.value: 214397.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-07-31<br />.value: 214579.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-08-31<br />.value: 207044.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-09-30<br />.value: 210526.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-10-31<br />.value: 218159.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-11-30<br />.value: 212774.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2020-12-31<br />.value: 232338.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-01-31<br />.value: 194277.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-02-28<br />.value: 196736.5<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-03-31<br />.value: 212911.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-04-30<br />.value: 203828.3<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-05-31<br />.value: 202232.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-06-30<br />.value: 210098.6<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-07-31<br />.value: 199275.7<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-08-31<br />.value: 194056.4<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL","Date: 2021-09-30<br />.value: 204194.1<br />.model_desc: ACTUAL<br />.model_desc: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18566,18596,18627,18658,18686,18717,18747,18778,18808,18839,18870,18900],"y":[217218.549122441,213443.669939006,232304.942950567,202142.135582369,203987.251043641,211152.893596518,199692.890060755,197792.642836145,205616.151912237,203902.665901683,199767.746445066,201923.837477069],"text":["Date: 2020-10-31<br />.value: 217218.5<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2020-11-30<br />.value: 213443.7<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2020-12-31<br />.value: 232304.9<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2021-01-31<br />.value: 202142.1<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2021-02-28<br />.value: 203987.3<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2021-03-31<br />.value: 211152.9<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2021-04-30<br />.value: 199692.9<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2021-05-31<br />.value: 197792.6<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2021-06-30<br />.value: 205616.2<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2021-07-31<br />.value: 203902.7<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2021-08-31<br />.value: 199767.7<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS","Date: 2021-09-30<br />.value: 201923.8<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS<br />.model_desc: ENSEMBLE (MEDIAN): 2 MODELS"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(33,144,140,1)","dash":"solid"},"hoveron":"points","name":"ENSEMBLE (MEDIAN): 2 MODELS","legendgroup":"ENSEMBLE (MEDIAN): 2 MODELS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18870,18900],"y":[208041.646948809,210630.068549162],"text":["Date: 2021-08-31<br />.value: 208041.6<br />.model_desc: Forecast (BE)<br />.model_desc: Forecast (BE)","Date: 2021-09-30<br />.value: 210630.1<br />.model_desc: Forecast (BE)<br />.model_desc: Forecast (BE)"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)","dash":"solid"},"hoveron":"points","name":"Forecast (BE)","legendgroup":"Forecast (BE)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":95.7011207970112,"r":39.8505603985056,"b":86.8410128684101,"l":101.452885014529},"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605},"title":{"text":"<b> Ensemble Model Vs Traditional Method (Best Estimate) <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":23.9103362391034},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[17111.85,18985.15],"tickmode":"array","ticktext":["2017","2018","2019","2020","2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["2017","2018","2019","2020","2021"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"y","title":{"text":"Date","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[188099.18491472,319157.72301488],"tickmode":"array","ticktext":["200000","240000","280000"],"tickvals":[200000,240000,280000],"categoryorder":"array","categoryarray":["200000","240000","280000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"x","title":{"text":"Revenue (Actuals)","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":12.2208385222084},"y":0.932086614173228},"annotations":[{"text":".model_desc","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"49046263271":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"49046263271","visdat":{"49046263271":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

We can clearly see that our **ENSEMBLE MODEL** is a better approach, compared to the traditional method.


Next, we are displaying the **MAE** metric, comparing both Ensemble and traditional method (Best Estimate):


```r
table_forecast_ensemble_metrics %>%
  select(.model_desc, .value, value_trans) %>%
  group_by(.model_desc) %>%  
  summarize_accuracy_metrics(
    truth      = value_trans, 
    estimate   = .value,
    metric_set = metric_set(mae)
  )
```

```
## # A tibble: 3 × 2
##   .model_desc                    mae
##   <chr>                        <dbl>
## 1 ACTUAL                          0 
## 2 ENSEMBLE (MEDIAN): 2 MODELS  3682.
## 3 Forecast (BE)               10211.
```

```r
#Turn OFF Parallel Backend
plan(sequential)
```

These results are showing that our ensemble model is a better method for predicting the actual revenue. We had a MAE metric of 3,746.3 and it was reduced in about 6464.2.


### 14. FINAL WORDS AND RECOMMENDATIONS


**(1)** According to our proposal, the ensemble model have improved the forecasting accuracy in about 63%. These results were compared to the best estimate method provided by finance (traditional method) by taking the last 2 months (August / September 2021) of the data.

**(2)** The current proposal states that our new model will be a better approach to the traditional method. It’s recommended to test this proposal during the next 2 months.

**(3)** Machine Learning is a continuous process, so it’s recommended to continuously calibrate the proposed model (at least every month) from now on.

**(4)** Next steps are to publish the model using our tools such as POWER BI and Shiny and keep monitoring the performance during the next 2 months. Unless there are no changes in our current commercial structure, we shall continue with the proposal; otherwise, it’s recommended to run the process again and taking into account the new changes on the structure.


